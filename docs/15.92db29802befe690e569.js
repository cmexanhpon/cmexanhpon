(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{kk3Z:function(t,e,n){"use strict";n.r(e),n.d(e,"ClientModule",function(){return Ht});var r=n("Hgu+"),i=n("OpKh"),a=n("uRpX"),o=n("ofXK"),s=n("PCNd"),c=n("3Pt+"),l=n("tyNb"),b=n("mrSG"),u=n("1XBi"),d=n("AytR"),m=n("fXoL"),g=n("7VIp"),h=n("tk/3");let p=(()=>{class t{constructor(t){this.httpClient=t,this.serviceUrl=d.a.BASE_API_URL+"/api/clienttrainingprogram"}create(t){return t=Object.assign(Object.assign({},t),{fromDate:t.fromDate?Object(g.b)(t.fromDate):null,toDate:t.toDate?Object(g.b)(t.toDate):null}),this.httpClient.post(this.serviceUrl,t)}uploadFile(t){let e=new FormData;return e.append("File",t),this.httpClient.post(this.serviceUrl+"/upload-file-training-program",e)}}return t.\u0275fac=function(e){return new(e||t)(m.Xb(h.c))},t.\u0275prov=m.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=n("CFL1"),S=n("EWJI"),v=n("2I5R"),T=n("AVD9"),z=n("n/iK"),C=n("QlUG"),y=n("1Uxm"),N=n("IiJ/"),P=n("UQmu"),j=n("OzZK"),w=n("RwU8"),I=n("C2AL"),O=n("+oEP"),H=n("FwiY");function U(t,e){if(1&t&&(m.Tb(0,"div",19),m.Tb(1,"div",9),m.Ob(2,"app-autocomplete-training-program-subject",20),m.Sb(),m.Tb(3,"div",9),m.Ob(4,"app-input",21),m.Tb(5,"button",22),m.Hc(6,"H\u01b0\u1edbng d\u1eabn quy \u0111\u1ed5i "),m.Ob(7,"i",23),m.Sb(),m.Sb(),m.Sb()),2&t){const t=e.index,n=m.dc(),r=m.tc(18);m.jc("formGroupName",t),m.zb(2),m.jc("listData",n.listSubject),m.zb(3),m.jc("nzPopoverContent",r)}}function D(t,e){if(1&t&&(m.Tb(0,"div",24),m.Ob(1,"div",25),m.Sb()),2&t){const t=m.dc();m.zb(1),m.jc("innerHTML",t.conversionInstruction,m.wc)}}let F=(()=>{class t extends u.a{constructor(t,e,n,r){super(t),this.clientTrainingProgramService=e,this.userService=n,this.settingService=r,this.listSubject=[],this.conversionInstruction=""}ngOnInit(){this.form=this.formBuilder.group({trainingFormId:[null,c.u.required],name:[null,c.u.required],code:[null],fromDate:[null],toDate:[null,c.u.required],organizationId:[null],organizationInput:[null],address:[null],note:[null],metaDataObject:this.formBuilder.group({trainingSubjects:this.formBuilder.array([])}),trainingProgram_Users:this.formBuilder.array([])}),this.addTrainingProgram_UserRow(),this.fetchConversionInstruction()}get trainingSubjects(){return this.form.get("metaDataObject.trainingSubjects")}addTrainingSubjectRow(t){this.trainingSubjects.push(this.createTrainingSubjectItem(t))}deleteTrainingSubjectRow(t){this.trainingSubjects.removeAt(t)}createTrainingSubjectItem(t){return this.formBuilder.group({name:[t?t.name:null,[c.u.required]],code:[t?t.code:null],order:[t?t.order:null],amount:[t?t.amount:null,[c.u.required]]})}get trainingProgram_Users(){return this.form.controls.trainingProgram_Users}addTrainingProgram_UserRow(t){this.trainingProgram_Users.push(this.createTrainingProgram_UserItem(t))}deleteTrainingProgram_UserRow(t){this.trainingProgram_Users.removeAt(t)}createTrainingProgram_UserItem(t){return this.formBuilder.group({userId:[this.tokenUser.id,[c.u.required]],trainingSubjectName:[null],pathToUploadFile:[null],amount:[4,[c.u.required]],active:[!1],hidden:[null]})}onChangeFile(t){this.uploadFile=t}onSave(){return Object(b.a)(this,void 0,void 0,function*(){for(const t in this.form.controls)this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity();for(const t in this.trainingProgram_Users.controls){const e=this.trainingProgram_Users.controls[t];for(const t in e.controls)e.controls[t].markAsDirty(),e.controls[t].updateValueAndValidity()}this.uploadFile?this.form.valid&&(this.loading=!0,yield this.clientTrainingProgramService.uploadFile(this.uploadFile).toPromise().then(t=>{if(!t||!t.success)return this.loading=!1,void this.message.error("L\u1ed7i: "+t.message);this.trainingProgram_Users.at(0).controls.pathToUploadFile.setValue(t.data),this.clientTrainingProgramService.create(this.form.value).toPromise().then(t=>{this.loading=!1,t&&t.success?this.isModal&&(this.message.success("G\u1eedi y\xeau c\u1ea7u th\xe0nh c\xf4ng, Ph\xf2ng C\u0110T s\u1ebd duy\u1ec7t trong th\u1eddi gian s\u1edbm nh\u1ea5t",{nzDuration:1e4}),this.modal.destroy(t.data)):this.message.error("L\u1ed7i: "+t.message)})})):this.message.error("Vui l\xf2ng cung c\u1ea5p file minh ch\u1ee9ng")})}get internalOrganizationId(){return d.a.INTERNAL_ORGANIZATION_ID}onCancel(){this.isModal&&this.modal.destroy()}onTrainingFormChange(t){for(this.listSubject=t.trainingSubjects;this.trainingSubjects.length;)this.trainingSubjects.removeAt(0);t&&t.trainingSubjects&&t.trainingSubjects.forEach(t=>{this.addTrainingSubjectRow(t)})}onChangeTrainingSubject(t,e){this.trainingProgram_Users.at(e).controls.amount.setValue(t.amount)}onChooseTrainingSubject(t){if(t){this.chooseForm.controls.trainingSubject.reset();for(const e in this.trainingProgram_Users.controls)this.trainingProgram_Users.controls[e].controls.trainingSubjectName.setValue(t.name)}}onDuplicateOrganization(t){this.form.controls.organizationId.setValue(t?t.id:null)}fetchConversionInstruction(){this.settingService.getByKey("conversion-instruction").toPromise().then(t=>{t&&t.success&&(this.conversionInstruction=t.data&&t.data.value||"")})}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(m.r),m.Nb(p),m.Nb(f.a),m.Nb(S.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-client-create-training-program"]],features:[m.wb],decls:28,vars:7,consts:[[1,"page-header"],[3,"loading","onClick"],[3,"onClick"],[3,"formGroup","keydown.enter"],[1,"row","m-t-30"],[1,"col-md-12"],["formControlName","trainingFormId","required","",3,"span","onChange"],[1,"row"],["type","text","labelContent","N\u1ed9i dung","formControlName","name","required","",3,"span"],[1,"col-md-6"],["type","datepicker","labelContent","T\u1eeb ng\xe0y","formControlName","fromDate"],["type","datepicker","labelContent","\u0110\u1ebfn ng\xe0y","formControlName","toDate","required",""],["formArrayName","trainingProgram_Users"],["class","row",3,"formGroupName",4,"ngFor","ngForOf"],["contentTemplate",""],["formControlName","organizationInput",3,"span","onDuplicate"],["type","textarea","labelContent","\u0110\u1ecba \u0111i\u1ec3m t\u1ed5 ch\u1ee9c","formControlName","address"],["type","textarea","labelContent","Ghi ch\xfa","formControlName","note"],[3,"required","onChange"],[1,"row",3,"formGroupName"],["labelContent","\u0110\u1ed1i t\u01b0\u1ee3ng","formControlName","trainingSubjectName",3,"listData"],["type","number","labelContent","S\u1ed1 ti\u1ebft quy \u0111\u1ed5i","formControlName","amount","required",""],["nz-button","","nz-popover","","nzPopoverTitle","H\u01b0\u1edbng d\u1eabn quy \u0111\u1ed5i","nzPopoverTrigger","click","nzPopoverPlacement","bottomRight",1,"float-right","m-r-10",2,"font-style","italic","color","#1890ff",3,"nzPopoverContent"],["nz-icon","","nzType","info-circle","nzTheme","outline",1,"m-l-5"],[1,"conversion-instruction-popover"],[1,"conversion-instruction-content",3,"innerHTML"]],template:function(t,e){1&t&&(m.Tb(0,"div",0),m.Tb(1,"app-button-save",1),m.ac("onClick",function(){return e.onSave()}),m.Sb(),m.Tb(2,"app-button-cancel",2),m.ac("onClick",function(){return e.onCancel()}),m.Sb(),m.Sb(),m.Tb(3,"form",3),m.ac("keydown.enter",function(t){return t.preventDefault()}),m.Tb(4,"div",4),m.Tb(5,"div",5),m.Tb(6,"app-select-training-form",6),m.ac("onChange",function(t){return e.onTrainingFormChange(t)}),m.Sb(),m.Sb(),m.Sb(),m.Tb(7,"div",7),m.Tb(8,"div",5),m.Ob(9,"app-input",8),m.Sb(),m.Sb(),m.Tb(10,"div",7),m.Tb(11,"div",9),m.Ob(12,"app-input",10),m.Sb(),m.Tb(13,"div",9),m.Ob(14,"app-input",11),m.Sb(),m.Sb(),m.Tb(15,"form",12),m.Fc(16,U,8,3,"div",13),m.Sb(),m.Fc(17,D,2,1,"ng-template",null,14,m.Gc),m.Tb(19,"div",7),m.Tb(20,"div",5),m.Tb(21,"app-autocomplete-organization",15),m.ac("onDuplicate",function(t){return e.onDuplicateOrganization(t)}),m.Sb(),m.Sb(),m.Sb(),m.Tb(22,"div",7),m.Tb(23,"div",9),m.Ob(24,"app-input",16),m.Sb(),m.Tb(25,"div",9),m.Ob(26,"app-input",17),m.Sb(),m.Sb(),m.Sb(),m.Tb(27,"app-dnd-upload",18),m.ac("onChange",function(t){return e.onChangeFile(t)}),m.Sb()),2&t&&(m.zb(1),m.jc("loading",e.loading),m.zb(2),m.jc("formGroup",e.form),m.zb(3),m.jc("span",2),m.zb(3),m.jc("span",2),m.zb(7),m.jc("ngForOf",e.trainingProgram_Users.controls),m.zb(5),m.jc("span",2),m.zb(6),m.jc("required",!0))},directives:[v.a,T.a,c.v,c.p,c.i,z.a,c.o,c.h,c.t,C.a,c.q,c.e,o.m,y.a,N.a,c.j,P.a,j.a,w.a,I.a,O.a,H.a],styles:[".conversion-instruction-popover[_ngcontent-%COMP%]{width:520px;padding:10px}.conversion-instruction-content[_ngcontent-%COMP%]{max-height:320px;overflow:auto}"]}),t})();var k=n("GHWL"),x=n("ri4K"),M=n("D9mS"),A=n("ZE2D"),L=n("5vDB"),_=n("AvTa"),R=n("Lxo8"),q=n("LojI"),V=n("TqlK");function Y(t,e){if(1&t){const t=m.Ub();m.Tb(0,"app-button-edit",28),m.ac("onClick",function(){return m.vc(t),m.dc().onEdit()}),m.Sb()}}function B(t,e){if(1&t){const t=m.Ub();m.Tb(0,"app-button-save",29),m.ac("onClick",function(){return m.vc(t),m.dc().onSave()}),m.Sb()}if(2&t){const t=m.dc();m.jc("loading",t.loading)}}const G=function(){return{label:"Nam",value:1}},E=function(){return{label:"N\u1eef",value:0}},J=function(t,e){return[t,e]},K=function(){return{label:"Trong \u0111\u01a1n v\u1ecb Xanhpon",value:"internal"}},Q=function(t){return[t]};let X=(()=>{class t extends u.a{constructor(t,e,n){super(t),this.authenticationService=e,this.userService=n,this.beforeUpload=t=>(this.avatarFile=t,this.getBase64(t,t=>{this.avatarFileUrl=t}),!1)}ngOnInit(){this.form=this.formBuilder.group({username:[null],fullname:[null,c.u.required],code:[null],certificateNumber:[null,c.u.required],issueDate:[null,c.u.required],birthDate:[null],gender:[null],email:[null,c.u.email],phoneNumber:[null,c.u.pattern(k.b)],organizationId:[null],departmentId:[null],titleId:[null],avatarUrl:[null],address:[null],identificationNumber:[null],type:["internal",c.u.required]}),this.fetchDetail()}fetchDetail(){this.userService.getById(this.id).toPromise().then(t=>{t&&t.success?(this.form.patchValue(t.data),this.isEdit||setTimeout(()=>this.form.disable(),300),t.data.type||this.form.controls.type.setValue("internal"),this.avatarFileUrl=k.a+"/"+t.data.avatarUrl):this.message.error("L\u1ed7i: "+t.message)})}getBase64(t,e){const n=new FileReader;n.addEventListener("load",()=>e(n.result)),n.readAsDataURL(t)}onChangeType(t){"internal"==t?(this.form.controls.organizationId.setValue("00000000-0000-0000-0000-000000000001"),this.form.controls.organizationId.disable()):"external"==t&&(this.form.controls.organizationId.setValue(null),this.form.controls.organizationId.enable())}onEdit(){this.isEdit=!0,this.form.enable(),"internal"==this.form.value.type&&this.form.controls.organizationId.disable()}onCancel(){this.isModal&&this.modal.destroy()}onSave(){for(const t in this.form.controls)this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity();this.form.valid&&(this.loading=!0,this.form.controls.username.setValue(this.form.getRawValue().certificateNumber),this.authenticationService.updateUser(this.form.getRawValue(),this.avatarFile).toPromise().then(t=>{this.loading=!1,t&&t.success?this.isModal&&(this.message.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"),this.modal.destroy(t)):this.message.error("L\u1ed7i: "+t.message)}))}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(m.r),m.Nb(x.a),m.Nb(f.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["app-client-edit-user"]],features:[m.wb],decls:50,vars:24,consts:[[1,"container"],[1,"page-header"],[3,"onClick",4,"ngIf"],[3,"loading","onClick",4,"ngIf"],[3,"popConfirm","onClick"],[3,"formGroup"],[1,"row"],[1,"col-xl-3"],[1,"row","m-v-20"],["nzName","avatar",1,"center",3,"nzShowUploadList","nzBeforeUpload"],["nzIcon","user",3,"nzSize","nzSrc"],[1,"col-xl-9"],[1,"col-md-6"],["type","text","labelContent","H\u1ecd t\xean","formControlName","fullname","required","true"],["type","text","labelContent","M\xe3","formControlName","code"],["type","text","labelContent","S\u1ed1 CCHN","formControlName","certificateNumber","required",""],["type","datepicker","labelContent","Ng\xe0y c\u1ea5p","formControlName","issueDate","required",""],["type","datepicker","labelContent","Ng\xe0y sinh","formControlName","birthDate"],["type","radio","labelContent","Gi\u1edbi t\xednh","formControlName","gender",3,"radioData"],["type","text","labelContent","Email","formControlName","email","errorTip","Sai \u0111\u1ecbnh d\u1ea1ng email"],["type","text","labelContent","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i","formControlName","phoneNumber","errorTip","Sai \u0111\u1ecbnh d\u1ea1ng S\u0110T"],["type","text","labelContent","S\u1ed1 CMND","formControlName","identificationNumber"],["type","textarea","labelContent","\u0110\u1ecba ch\u1ec9","formControlName","address"],[1,"col-md-12"],["type","radio","labelContent","\u0110\u1ed1i t\u01b0\u1ee3ng","formControlName","type",3,"span","radioData","onChange"],["formControlName","organizationId","required","true",3,"span"],["formControlName","departmentId",3,"organizationId"],["formControlName","titleId"],[3,"onClick"],[3,"loading","onClick"]],template:function(t,e){1&t&&(m.Tb(0,"div",0),m.Tb(1,"div",1),m.Fc(2,Y,1,0,"app-button-edit",2),m.Fc(3,B,1,1,"app-button-save",3),m.Tb(4,"app-button-cancel",4),m.ac("onClick",function(){return e.onCancel()}),m.Sb(),m.Sb(),m.Tb(5,"div"),m.Tb(6,"form",5),m.Tb(7,"div",6),m.Tb(8,"div",7),m.Tb(9,"div",8),m.Tb(10,"nz-upload",9),m.Ob(11,"nz-avatar",10),m.Sb(),m.Sb(),m.Sb(),m.Tb(12,"div",11),m.Tb(13,"div",6),m.Tb(14,"div",12),m.Ob(15,"app-input",13),m.Sb(),m.Tb(16,"div",12),m.Ob(17,"app-input",14),m.Sb(),m.Sb(),m.Tb(18,"div",6),m.Tb(19,"div",12),m.Ob(20,"app-input",15),m.Sb(),m.Tb(21,"div",12),m.Ob(22,"app-input",16),m.Sb(),m.Sb(),m.Tb(23,"div",6),m.Tb(24,"div",12),m.Ob(25,"app-input",17),m.Sb(),m.Tb(26,"div",12),m.Ob(27,"app-input",18),m.Sb(),m.Sb(),m.Tb(28,"div",6),m.Tb(29,"div",12),m.Ob(30,"app-input",19),m.Sb(),m.Tb(31,"div",12),m.Ob(32,"app-input",20),m.Sb(),m.Sb(),m.Tb(33,"div",6),m.Tb(34,"div",12),m.Ob(35,"app-input",21),m.Sb(),m.Tb(36,"div",12),m.Ob(37,"app-input",22),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Ob(38,"nz-divider"),m.Tb(39,"div",6),m.Tb(40,"div",23),m.Tb(41,"app-input",24),m.ac("onChange",function(t){return e.onChangeType(t)}),m.Sb(),m.Sb(),m.Sb(),m.Tb(42,"div",6),m.Tb(43,"div",23),m.Ob(44,"app-select-organization",25),m.Sb(),m.Sb(),m.Tb(45,"div",6),m.Tb(46,"div",12),m.Ob(47,"app-select-department",26),m.Sb(),m.Tb(48,"div",12),m.Ob(49,"app-select-title",27),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb()),2&t&&(m.zb(2),m.jc("ngIf",!e.isEdit),m.zb(1),m.jc("ngIf",e.isEdit),m.zb(1),m.jc("popConfirm",!!e.isEdit),m.zb(1),m.Bb(e.isModal?"m-t-30":""),m.zb(1),m.jc("formGroup",e.form),m.zb(4),m.jc("nzShowUploadList",!1)("nzBeforeUpload",e.beforeUpload),m.zb(1),m.jc("nzSize",200)("nzSrc",e.avatarFileUrl),m.zb(16),m.jc("radioData",m.pc(18,J,m.nc(16,G),m.nc(17,E))),m.zb(14),m.jc("span",2)("radioData",m.oc(22,Q,m.nc(21,K))),m.zb(3),m.jc("span",2),m.zb(3),m.jc("organizationId",e.form.getRawValue().organizationId))},directives:[o.n,T.a,c.v,c.p,c.i,M.a,A.a,C.a,c.o,c.h,c.t,L.a,_.a,R.a,q.a,V.a,v.a],styles:[""]}),t})();var Z=n("Y9CB"),W=n("ECBP"),$=n("dEAy"),tt=n("QH85"),et=n("JA5x"),nt=n("nJia"),rt=n("8+11"),it=n("k8vQ"),at=n("gyL+"),ot=n("zAKX"),st=n("0lU3"),ct=n("rMZv"),lt=n("W9fG"),bt=n("N6wO"),ut=n("b8ej"),dt=n("K143");function mt(t,e){1&t&&(m.Rb(0),m.Tb(1,"app-tag-done"),m.Hc(2,"X\xe1c nh\u1eadn"),m.Sb(),m.Qb())}function gt(t,e){1&t&&(m.Rb(0),m.Tb(1,"app-tag-danger"),m.Hc(2,"H\u1ee7y b\u1ecf"),m.Sb(),m.Qb())}function ht(t,e){1&t&&(m.Rb(0),m.Tb(1,"app-tag-not-done"),m.Hc(2,"Ch\u01b0a duy\u1ec7t"),m.Sb(),m.Qb())}function pt(t,e){if(1&t&&(m.Tb(0,"tr"),m.Tb(1,"td"),m.Hc(2),m.ec(3,"date"),m.Sb(),m.Tb(4,"td"),m.Hc(5),m.Sb(),m.Tb(6,"td"),m.Fc(7,mt,3,0,"ng-container",6),m.Fc(8,gt,3,0,"ng-container",6),m.Fc(9,ht,3,0,"ng-container",6),m.Sb(),m.Tb(10,"td"),m.Hc(11),m.Sb(),m.Sb()),2&t){const t=e.$implicit;m.zb(2),m.Ic(m.gc(3,6,t.createdOnDate,"dd/MM/yyyy")),m.zb(3),m.Ic(t.trainingProgram.name),m.zb(2),m.jc("ngIf","done"==t.trainingProgram.status||1==t.active),m.zb(1),m.jc("ngIf","cancel"==t.trainingProgram.status),m.zb(1),m.jc("ngIf",0==t.active&&"initial"==t.trainingProgram.status),m.zb(2),m.Ic(t.note)}}function ft(t,e){if(1&t&&(m.Rb(0),m.Tb(1,"nz-table",3,4),m.Tb(3,"thead"),m.Tb(4,"tr"),m.Tb(5,"th"),m.Hc(6,"Ng\xe0y g\u1eedi"),m.Sb(),m.Tb(7,"th"),m.Hc(8,"N\u1ed9i dung"),m.Sb(),m.Tb(9,"th"),m.Hc(10,"Tr\u1ea1ng th\xe1i"),m.Sb(),m.Tb(11,"th"),m.Hc(12,"L\xfd do"),m.Sb(),m.Sb(),m.Sb(),m.Tb(13,"tbody"),m.Fc(14,pt,12,9,"tr",5),m.Sb(),m.Sb(),m.Qb()),2&t){const t=m.tc(2),e=m.dc();m.zb(1),m.jc("nzData",e.listData),m.zb(13),m.jc("ngForOf",t.data)}}function St(t,e){if(1&t){const t=m.Ub();m.Rb(0),m.Tb(1,"button",7),m.ac("click",function(){return m.vc(t),m.dc().onCancel.emit()}),m.Hc(2,"\u0110\xf3ng"),m.Sb(),m.Qb()}}let vt=(()=>{class t{constructor(){this.visible=!1,this.listData=[],this.onCancel=new m.n}ngOnInit(){}openModal(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Hb({type:t,selectors:[["app-client-history-request"]],inputs:{visible:"visible",listData:"listData"},outputs:{onCancel:"onCancel"},decls:3,vars:1,consts:[["nzTitle","L\u1ecbch s\u1eed g\u1eedi y\xeau c\u1ea7u",3,"nzVisible","nzVisibleChange","nzOnCancel","nzAfterOpen"],[4,"nzModalContent"],[4,"nzModalFooter"],[3,"nzData"],["basicTable",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["nz-button","","nzType","default",3,"click"]],template:function(t,e){1&t&&(m.Tb(0,"nz-modal",0),m.ac("nzVisibleChange",function(t){return e.visible=t})("nzOnCancel",function(){return e.onCancel.emit()})("nzAfterOpen",function(){return e.openModal()}),m.Fc(1,ft,15,2,"ng-container",1),m.Fc(2,St,3,0,"ng-container",2),m.Sb()),2&t&&m.jc("nzVisible",e.visible)},directives:[$.a,$.b,$.c,ct.b,ct.j,ct.k,ct.a,ct.h,ct.e,o.m,o.n,bt.a,ut.a,dt.a,j.a,w.a,I.a],pipes:[o.e],styles:[""]}),t})();function Tt(t,e){if(1&t&&(m.Tb(0,"tr",56),m.Tb(1,"td",57),m.Hc(2),m.Sb(),m.Tb(3,"td"),m.Hc(4),m.Sb(),m.Tb(5,"td",47),m.Hc(6),m.Sb(),m.Tb(7,"td"),m.Hc(8),m.Sb(),m.Tb(9,"td"),m.Hc(10),m.ec(11,"date"),m.Sb(),m.Tb(12,"td"),m.Hc(13),m.ec(14,"date"),m.Sb(),m.Tb(15,"td"),m.Hc(16),m.Sb(),m.Tb(17,"td",58),m.Hc(18),m.Sb(),m.Sb()),2&t){const t=e.$implicit,n=e.index;m.jc("formGroupName",n)("hidden",t.value.hidden),m.zb(2),m.Jc(" ",n+1," "),m.zb(2),m.Jc(" ",t.value.trainingFormName," "),m.zb(2),m.Jc(" ",t.value.trainingProgramName," "),m.zb(2),m.Jc(" ",t.value.organizationName," "),m.zb(2),m.Jc(" ",m.gc(11,10,t.value.fromDate,"dd/MM/yyyy")," "),m.zb(3),m.Jc(" ",m.gc(14,13,t.value.toDate,"dd/MM/yyyy")," "),m.zb(3),m.Jc(" ",t.value.trainingSubjectName," "),m.zb(2),m.Jc(" ",t.value.amount," ")}}function zt(t,e){}const Ct=function(){return{standalone:!0}},yt=function(){return["T\u1eeb n\u0103m","\u0110\u1ebfn n\u0103m"]},Nt=function(t){return{color:t}},Pt=[{path:"",component:(()=>{class t extends W.a{constructor(t,e,n,r){super(t),this.userService=e,this.nzModalService=n,this.modalService=r,this.visibleHistory=!1,this.listTrainingProgram=[],this.user=this.tokenService.get()?this.tokenService.get().user:null,this.user&&(this.avatarPath=k.a+"/"+this.user.avatarUrl),this.searchForm=this.formBuilder.group({rangeYear:[[new Date,new Date]]}),this.form=this.formBuilder.group({trainingProgram_Users:this.formBuilder.array([])}),this.fetchList()}get trainingProgram_Users(){return this.form.controls.trainingProgram_Users}addTrainingProgram_UserRow(t){this.trainingProgram_Users.push(this.createTrainingProgram_UserItem(t))}createTrainingProgram_UserItem(t){return this.formBuilder.group({trainingProgramName:[t?t.trainingProgramName:null,[c.u.required]],trainingFormName:[{value:t?t.trainingFormName:null,disabled:!0}],fromDate:[{value:t?t.fromDate:null,disabled:!0}],toDate:[{value:t?t.toDate:null,disabled:!0}],trainingSubjectName:[{value:t?t.trainingSubjectName:null,disabled:!0}],organizationName:[{value:t?t.organizationName:null,disabled:!0}],amount:[t?this.userService.calculateAmountTrainingProgram(t,this.fromYear,this.toYear):null,[c.u.required]],hidden:[!1]})}fetchList(){if(this.user.id){for(;0!==this.trainingProgram_Users.length;)this.trainingProgram_Users.removeAt(0);this.loading=!0,this.userService.getTrainingPrograms(this.user.id,this.fromYear,this.toYear).toPromise().then(t=>{this.loading=!1,t&&t.success?(this.listTrainingProgram=t.data,t.data.filter(t=>1==t.active).forEach(t=>{this.addTrainingProgram_UserRow({trainingProgramName:t.trainingProgram.name,trainingProgramCode:t.trainingProgram.trainingForm.code,trainingFormName:t.trainingProgram.trainingForm.name,fromDate:t.trainingProgram.fromDate,toDate:t.trainingProgram.toDate,trainingSubjectName:t.trainingSubjectName,amount:t.amount,organizationName:t.trainingProgram.organization?t.trainingProgram.organization.name:t.trainingProgram.organizationInput})}),this.form.disable()):this.message.error("L\u1ed7i: "+t.message)})}}onSearch(t){this.loading=!0;for(const e in this.trainingProgram_Users.controls){const n=this.trainingProgram_Users.controls[e],r=n.getRawValue();if(t.length>0){let e=!0;t.forEach(t=>{r.trainingProgramName&&r.trainingProgramName.toLowerCase().includes(t.toLowerCase())||r.trainingFormName&&r.trainingFormName.toLowerCase().includes(t.toLowerCase())||r.trainingSubjectName&&r.trainingSubjectName.toLowerCase().includes(t.toLowerCase())||r.amount&&r.amount.toString().toLowerCase().includes(t.toLowerCase())||(e=!1)}),n.controls.hidden.setValue(!e)}else n.controls.hidden.setValue(!1)}this.loading=!1}get year(){return(new Date).getFullYear()}get amoutInYear(){let t=0;return this.trainingProgram_Users.value.forEach(e=>{t+=e.amount}),t}getDepartmentAndOrganization(t,e){let n=t?t+", ":"";return n+=e||"",n}goToEdit(){this.modalService.openDetailModal(X,this.user.id,!0,"1000px","20px").afterClose.toPromise().then(t=>{t&&(this.tokenService.updateUser(t.data),this.user=t.data,this.avatarPath=k.a+"/"+this.user.avatarUrl)})}updateUserInfo(){this.userService.updateUserInfo(this.user.id,this.form.getRawValue(),this.avatarFile).toPromise().then(t=>{t&&t.success?(this.message.remove(),this.message.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"),this.tokenService.updateUser(t.data)):this.message.error("L\u1ed7i: "+t.message)})}goToCreate(){this.modalService.openCreateModal(F,"1000px","20px",!0).afterClose.toPromise().then(t=>{})}changePassword(){return this.nzModalService.create({nzTitle:"\u0110\u1ed5i m\u1eadt kh\u1ea9u",nzContent:Z.a,nzComponentParams:{isModal:!0},nzFooter:null})}logout(){this.tokenService.set(null),this.router.navigateByUrl(this.tokenService.login_url)}get fromYear(){return this.searchForm.value.rangeYear[0].getFullYear()}get toYear(){return this.searchForm.value.rangeYear[1].getFullYear()}get totalAmount(){return this.searchForm.value.rangeYear?24*(this.toYear-this.fromYear+1):null}}return t.\u0275fac=function(e){return new(e||t)(m.Nb(m.r),m.Nb(f.a),m.Nb($.f),m.Nb(tt.a))},t.\u0275cmp=m.Hb({type:t,selectors:[["ng-component"]],features:[m.wb],decls:118,vars:38,consts:[[1,"container-fluid","p-h-0","p-v-20","h-100","bg",2,"background-image","url('assets/images/others/login-3.png')","background-repeat","no-repeat","background-attachment","fixed"],[1,"d-flex","flex-column","justify-content-between","h-100"],[1,"d-none","d-md-block"],[1,"container",2,"margin","auto"],["id","invoice",1,"p-h-30"],[1,"m-t-15","lh-2"],[1,"row"],[1,"col-md-8"],[1,"col-md-3","center"],["nzIcon","user",3,"nzSize","nzSrc"],[1,"col-md-9"],[1,"p-l-10","m-t-20"],[1,"font-weight-bold","font-size-20","text-highlight"],[1,"icon-edit",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline","nzTooltipTitle","Thay \u0111\u1ed5i th\xf4ng tin","nzTooltipPlacement","topCenter","nz-tooltip",""],[1,"col-md-4"],[1,"float-right"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","logout","nzTheme","outline"],["nz-icon","","nzType","key","nzTheme","outline"],[1,"row","m-t-20","lh-2","justify-content-between"],[1,"p-l-10","m-t-10"],["iconType","history",3,"onClick"],[3,"onClick"],[3,"formGroup"],[1,"row","m-b-10"],["nzMode","tags","nzPlaceHolder","T\xecm ki\u1ebfm...",1,"w-100",3,"ngModel","ngModelOptions","ngModelChange"],["nzMode","year","formControlName","rangeYear",1,"w-100",3,"nzPlaceHolder","nzAllowClear","ngModelChange"],[1,"row","m-t-20"],[1,"col-sm-12"],[1,"w-100",3,"nzLoading","nzNoResult"],["dynamicTable",""],["width","30px",1,"center"],["width","170px"],["width","100px"],["width","150px"],["width","70px"],["formArrayName","trainingProgram_Users"],[3,"formGroupName","hidden",4,"ngFor","ngForOf"],["class","no-result"],["nzNoResult",""],[1,"row","m-t-30","lh-1-8"],[1,"float-right","text-right"],[3,"nzPercent","nzShowInfo","nzStrokeColor","nzStatus"],[3,"ngStyle"],[1,"m-l-5",3,"innerHTML"],[1,"font-weight-semibold","text-dark","m-t-5","m-r-10"],[1,"text-highlight"],[1,"row","m-t-30","lh-2"],[1,"row","m-v-20"],[1,"col-sm-1"],["alt","","src","assets/images/logo/logo-xanhpon.png",1,"img-fluid","text-opacity","m-t-5",2,"width","50px","height","50px"],[1,"col-sm-5","center"],[1,"m-b-0","float-left"],[1,"col-sm-6","text-right"],[3,"visible","listData","onCancel"],[3,"formGroupName","hidden"],[1,"text-center"],[1,"text-right","font-weight-semibold"]],template:function(t,e){if(1&t&&(m.Tb(0,"div",0),m.Tb(1,"div",1),m.Ob(2,"div",2),m.Tb(3,"div",3),m.Tb(4,"nz-card"),m.Tb(5,"div",4),m.Tb(6,"div",5),m.Tb(7,"div",6),m.Tb(8,"div",7),m.Tb(9,"div",6),m.Tb(10,"div",8),m.Ob(11,"nz-avatar",9),m.Sb(),m.Tb(12,"div",10),m.Tb(13,"address",11),m.Tb(14,"span",12),m.Hc(15),m.ec(16,"uppercase"),m.Sb(),m.Tb(17,"span",13),m.ac("click",function(){return e.goToEdit()}),m.Ob(18,"i",14),m.Hc(19," Ch\u1ec9nh s\u1eeda "),m.Sb(),m.Ob(20,"br"),m.Tb(21,"span"),m.Hc(22,"S\u1ed1 CCHN: "),m.Tb(23,"strong"),m.Hc(24),m.Sb(),m.Sb(),m.Ob(25,"br"),m.Tb(26,"span"),m.Hc(27,"N\u0103m c\u1ea5p: "),m.Tb(28,"strong"),m.Hc(29),m.ec(30,"date"),m.Sb(),m.Sb(),m.Ob(31,"br"),m.Tb(32,"span"),m.Hc(33,"Khoa/ph\xf2ng: "),m.Tb(34,"strong"),m.Hc(35),m.Sb(),m.Sb(),m.Ob(36,"br"),m.Tb(37,"span"),m.Hc(38,"Ch\u1ee9c v\u1ee5: "),m.Tb(39,"strong"),m.Hc(40),m.Sb(),m.Sb(),m.Ob(41,"br"),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(42,"div",15),m.Tb(43,"div",16),m.Tb(44,"button",17),m.ac("click",function(){return e.logout()}),m.Ob(45,"i",18),m.Hc(46," \u0110\u0103ng xu\u1ea5t"),m.Sb(),m.Sb(),m.Tb(47,"div",16),m.Tb(48,"button",17),m.ac("click",function(){return e.changePassword()}),m.Ob(49,"i",19),m.Hc(50," \u0110\u1ed5i m\u1eadt kh\u1ea9u"),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(51,"div",20),m.Tb(52,"h3",21),m.Hc(53,"Ch\u01b0\u01a1ng tr\xecnh \u0111\xe0o t\u1ea1o \u0111\xe3 tham gia"),m.Sb(),m.Tb(54,"div"),m.Tb(55,"app-button-base",22),m.ac("onClick",function(){return e.visibleHistory=!0}),m.Hc(56,"L\u1ecbch s\u1eed"),m.Sb(),m.Tb(57,"app-button-reload",23),m.ac("onClick",function(){return e.fetchList()}),m.Sb(),m.Tb(58,"app-button-create",23),m.ac("onClick",function(){return e.goToCreate()}),m.Sb(),m.Sb(),m.Sb(),m.Tb(59,"form",24),m.Tb(60,"div",25),m.Tb(61,"div",7),m.Tb(62,"nz-select",26),m.ac("ngModelChange",function(t){return e.onSearch(t)}),m.Sb(),m.Sb(),m.Tb(63,"div",15),m.Tb(64,"nz-range-picker",27),m.ac("ngModelChange",function(){return e.fetchList()}),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(65,"div",28),m.Tb(66,"div",29),m.Tb(67,"form",24),m.Tb(68,"nz-table",30,31),m.Tb(70,"thead"),m.Tb(71,"tr"),m.Tb(72,"th",32),m.Hc(73,"STT"),m.Sb(),m.Tb(74,"th",33),m.Hc(75,"H\xecnh th\u1ee9c \u0111\xe0o t\u1ea1o"),m.Sb(),m.Tb(76,"th"),m.Hc(77,"N\u1ed9i dung"),m.Sb(),m.Tb(78,"th",33),m.Hc(79,"\u0110\u01a1n v\u1ecb t\u1ed5 ch\u1ee9c"),m.Sb(),m.Tb(80,"th",34),m.Hc(81,"T\u1eeb ng\xe0y"),m.Sb(),m.Tb(82,"th",34),m.Hc(83,"\u0110\u1ebfn ng\xe0y"),m.Sb(),m.Tb(84,"th",35),m.Hc(85,"\u0110\u1ed1i t\u01b0\u1ee3ng"),m.Sb(),m.Tb(86,"th",36),m.Hc(87,"Quy \u0111\u1ed5i"),m.Sb(),m.Sb(),m.Sb(),m.Tb(88,"tbody",37),m.Fc(89,Tt,19,16,"tr",38),m.Sb(),m.Sb(),m.Fc(90,zt,0,0,"ng-template",39,40,m.Gc),m.Sb(),m.Tb(92,"div",41),m.Tb(93,"div",29),m.Tb(94,"div",42),m.Tb(95,"p"),m.Ob(96,"nz-progress",43),m.Tb(97,"strong"),m.Hc(98),m.Sb(),m.Hc(99),m.Tb(100,"span",44),m.Hc(101),m.Sb(),m.Ob(102,"span",45),m.Sb(),m.Tb(103,"h3"),m.Tb(104,"span",46),m.Hc(105,"T\u1ed5ng s\u1ed1 ti\u1ebft:"),m.Sb(),m.Tb(106,"span",47),m.Hc(107),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(108,"div",48),m.Ob(109,"div",29),m.Sb(),m.Tb(110,"div",49),m.Tb(111,"div",50),m.Ob(112,"img",51),m.Sb(),m.Tb(113,"div",52),m.Tb(114,"p",53),m.Hc(115),m.Sb(),m.Sb(),m.Ob(116,"div",54),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(117,"app-client-history-request",55),m.ac("onCancel",function(){return e.visibleHistory=!1}),m.Sb()),2&t){const t=m.tc(91);m.zb(11),m.jc("nzSize",150)("nzSrc",e.avatarFileUrl?e.avatarFileUrl:e.avatarPath?e.avatarPath:null),m.zb(4),m.Ic(m.fc(16,29,e.user.fullname)),m.zb(9),m.Ic(e.user.certificateNumber),m.zb(5),m.Ic(m.gc(30,31,e.user.issueDate,"dd/MM/yyyy")),m.zb(6),m.Ic(e.getDepartmentAndOrganization(null==e.user.department?null:e.user.department.name,null==e.user.organization?null:e.user.organization.name)),m.zb(5),m.Ic(null==e.user.title?null:e.user.title.name),m.zb(19),m.jc("formGroup",e.searchForm),m.zb(3),m.jc("ngModel",e.listTextSearch)("ngModelOptions",m.nc(34,Ct)),m.zb(2),m.jc("nzPlaceHolder",m.nc(35,yt))("nzAllowClear",!1),m.zb(3),m.jc("formGroup",e.form),m.zb(1),m.jc("nzLoading",e.loading)("nzNoResult",t),m.zb(21),m.jc("ngForOf",e.trainingProgram_Users.controls),m.zb(7),m.jc("nzPercent",e.amoutInYear/e.totalAmount*100)("nzShowInfo",e.userService.showInfo(e.amoutInYear,e.totalAmount))("nzStrokeColor",e.userService.getColor(e.amoutInYear,e.totalAmount))("nzStatus",e.userService.getStatus(e.amoutInYear,e.totalAmount)),m.zb(2),m.Ic(e.amoutInYear),m.zb(1),m.Jc("/",e.totalAmount," - "),m.zb(1),m.jc("ngStyle",m.oc(36,Nt,e.userService.getColor(e.amoutInYear,e.totalAmount))),m.zb(1),m.Ic(e.userService.getTextStatus(e.amoutInYear,e.totalAmount)),m.zb(1),m.jc("innerHTML",e.userService.getHtmlRemain(e.amoutInYear,e.totalAmount),m.wc),m.zb(5),m.Jc(" ",e.amoutInYear,""),m.zb(8),m.Jc("Copyright \xa9 ",e.year,". All rights reserved."),m.zb(2),m.jc("visible",e.visibleHistory)("listData",e.listTrainingProgram)}},directives:[et.a,A.a,I.a,H.a,nt.d,j.a,w.a,rt.a,it.a,at.a,c.v,c.p,c.i,ot.b,c.o,c.r,st.b,st.d,c.h,ct.b,ct.j,ct.k,ct.a,ct.h,ct.e,c.e,o.m,lt.a,o.o,vt,c.j],pipes:[o.w,o.e],styles:[".icon-edit[_ngcontent-%COMP%]{margin-left:10px;color:#72849a}.icon-edit[_ngcontent-%COMP%]:hover{color:#2f54eb;cursor:pointer}"]}),t})()}];let jt=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},imports:[[l.i.forChild(Pt)],l.i]}),t})();var wt=n("hMaZ"),It=n("jdXR"),Ot=n("el8y");let Ht=(()=>{class t{}return t.\u0275mod=m.Lb({type:t}),t.\u0275inj=m.Kb({factory:function(e){return new(e||t)},imports:[[o.c,s.a,c.s,a.a,jt,i.AuthenticationModule,Ot.TitleModule,It.OrganizationModule,wt.DepartmentModule,r.TrainingFormModule]]}),t})()}}]);