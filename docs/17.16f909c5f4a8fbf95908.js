(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{j0CL:function(e,t,n){"use strict";n.r(t),n.d(t,"TrainingProgramModule",function(){return Ft});var a=n("7UCR"),i=n("hMaZ"),r=n("jdXR"),o=n("Hgu+"),c=n("7VIp"),s=n("1XBi"),l=n("3Pt+"),b=n("AytR"),d=n("fXoL"),u=n("fseX"),g=n("CFL1"),m=n("ofXK"),h=n("AVD9"),p=n("oyxB"),f=n("TqlK"),S=n("2I5R"),T=n("JA5x"),C=n("mrSG"),z=n("OG76"),v=n("HwMn"),j=n("QH85"),y=n("DuPd"),P=n("PScX"),N=n("QlUG"),k=n("8+11"),I=n("gyL+");function w(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div",2),d.Tb(1,"app-button-base",3),d.ac("onClick",function(){return d.sc(e),d.dc().goToList()}),d.Ec(2,"T\xecm ki\u1ebfm"),d.Sb(),d.Tb(3,"app-button-create",4),d.ac("onClick",function(){return d.sc(e),d.dc().goToCreate()}),d.Sb(),d.Sb()}}let D=(()=>{class e{constructor(e,t,n,a){this.ngControl=e,this.modalService=t,this.trainingFormService=n,this.message=a,this.labelContent="H\xecnh th\u1ee9c \u0111\xe0o t\u1ea1o",this.span=4,this.required=!1,this.labelHorizontal=!0,this.onChange=new d.n,this.listData=[],this.loading=!1,null!=this.ngControl&&(this.ngControl.valueAccessor=this)}ngOnInit(){this.fetchList()}writeValue(e){}registerOnChange(e){}registerOnTouched(e){}setDisabledState(e){}handleChange(e){this.onChange.emit(e)}fetchList(){this.trainingFormService.getList().toPromise().then(e=>{this.loading=!1,e&&e.success?this.listData=e.data.content:this.message.error(e.message)})}goToList(){this.modalService.openListModal(z.a).afterClose.toPromise().then(e=>Object(C.a)(this,void 0,void 0,function*(){e&&this.ngControl.control.setValue(e.id)}))}goToCreate(){this.modalService.openCreateModal(v.a).afterClose.toPromise().then(e=>Object(C.a)(this,void 0,void 0,function*(){e&&(this.fetchList(),this.ngControl.control.setValue(e.id))}))}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(l.m,10),d.Nb(j.a),d.Nb(y.a),d.Nb(P.e))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-select-training-form"]],inputs:{labelContent:"labelContent",span:"span",required:"required",labelHorizontal:"labelHorizontal"},outputs:{onChange:"onChange"},decls:3,vars:8,consts:[["type","select","labelField","name",3,"labelHorizontal","selectData","span","labelContent","formControl","required","footerSelectTemplate","loading","onChange"],["footer",""],[1,"container","m-5"],["iconType","search",3,"onClick"],[3,"onClick"]],template:function(e,t){if(1&e&&(d.Tb(0,"app-input",0),d.ac("onChange",function(e){return t.handleChange(e)}),d.Sb(),d.Cc(1,w,4,0,"ng-template",null,1,d.Dc)),2&e){const e=d.rc(2);d.jc("labelHorizontal",t.labelHorizontal)("selectData",t.listData)("span",t.span)("labelContent",t.labelContent)("formControl",t.ngControl.control)("required",t.required)("footerSelectTemplate",e)("loading",t.loading)}},directives:[N.a,l.n,l.g,l.r,k.a,I.a],styles:[""]}),e})();var x=n("AvTa"),U=n("rMZv"),E=n("r7RV"),O=n("OzZK"),F=n("RwU8"),L=n("C2AL"),M=n("FwiY"),_=n("zAKX"),V=n("+oEP"),A=n("Lxo8"),R=n("TIPB"),q=n("TaO5"),H=n("2Vo4"),G=n("yrJp"),B=n("259m"),$=n("Kj3r");function K(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div",2),d.Tb(1,"app-button-base",3),d.ac("onClick",function(){return d.sc(e),d.dc().goToList()}),d.Ec(2,"T\xecm ki\u1ebfm"),d.Sb(),d.Tb(3,"app-button-create",4),d.ac("onClick",function(){return d.sc(e),d.dc().goToCreate()}),d.Sb(),d.Sb()}}const X=function(){return["fullname","certificateNumber"]};let Q=(()=>{class e{constructor(e,t,n,a,i){this.ngControl=t,this.modalService=n,this.userService=a,this.message=i,this.labelContent="C\xe1n b\u1ed9",this.span=4,this.required=!1,this.labelHorizontal=!0,this.onChange=new d.n,this.listData=[],this.loading=!1,this.searchChange$=new H.a(""),this.listTextSearch=[],null!=this.ngControl&&(this.ngControl.valueAccessor=this)}ngOnInit(){this.initSearch()}writeValue(e){}registerOnChange(e){}registerOnTouched(e){}setDisabledState(e){}handleChange(e){this.onChange.emit(e)}fetchList(){const e=JSON.stringify({ListTextSearch:this.listTextSearch});this.userService.getList(1,20,"+FirstName",e).toPromise().then(e=>{this.loading=!1,e&&e.success?this.listData=e.data.content:this.message.error(e.message)})}goToList(){this.modalService.openListModal(B.a).afterClose.toPromise().then(e=>Object(C.a)(this,void 0,void 0,function*(){e&&this.ngControl.control.setValue(e.id)}))}goToCreate(){this.modalService.openCreateModal(G.a).afterClose.toPromise().then(e=>Object(C.a)(this,void 0,void 0,function*(){e&&(this.listData=[...this.listData,e],this.ngControl.control.setValue(e.id),this.onChange.emit(e))}))}initSearch(){this.searchChange$.asObservable().pipe(Object($.a)(500)).subscribe(e=>{this.listTextSearch=[e],this.fetchList()})}onSearch(e){this.searchChange$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(l.m,10),d.Nb(j.a),d.Nb(g.a),d.Nb(P.e))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-select-user"]],inputs:{labelContent:"labelContent",span:"span",required:"required",labelHorizontal:"labelHorizontal",placeholder:"placeholder"},outputs:{onChange:"onChange"},decls:3,vars:11,consts:[["type","select",3,"labelField","labelHorizontal","placeholder","selectData","span","labelContent","formControl","required","footerSelectTemplate","loading","onChange","onSearch"],["footer",""],[1,"container","m-5"],["iconType","search",3,"onClick"],[3,"onClick"]],template:function(e,t){if(1&e&&(d.Tb(0,"app-input",0),d.ac("onChange",function(e){return t.handleChange(e)})("onSearch",function(e){return t.onSearch(e)}),d.Sb(),d.Cc(1,K,4,0,"ng-template",null,1,d.Dc)),2&e){const e=d.rc(2);d.jc("labelField",d.lc(10,X))("labelHorizontal",t.labelHorizontal)("placeholder",t.placeholder)("selectData",t.listData)("span",t.span)("labelContent",t.labelContent)("formControl",t.ngControl.control)("required",t.required)("footerSelectTemplate",e)("loading",t.loading)}},directives:[N.a,l.n,l.g,l.r,k.a,I.a],styles:[""]}),e})();function J(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-edit",10),d.ac("onClick",function(){return d.sc(e),d.dc().onEdit()}),d.Sb()}}function W(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-save",11),d.ac("onClick",function(){return d.sc(e),d.dc().onSave()}),d.Sb()}if(2&e){const e=d.dc();d.jc("loading",e.loading)}}function Z(e,t){1&e&&d.Pb(0)}function Y(e,t){1&e&&d.Pb(0)}function ee(e,t){1&e&&d.Ob(0,"th",34)}function te(e,t){if(1&e){const e=d.Ub();d.Tb(0,"td",36),d.Tb(1,"app-circle-button-delete",10),d.ac("onClick",function(){d.sc(e);const t=d.dc().index;return d.dc(2).deleteTrainingSubjectRow(t)}),d.Sb(),d.Sb()}}function ne(e,t){if(1&e&&(d.Tb(0,"tr",35),d.Tb(1,"td",36),d.Ec(2),d.Ob(3,"app-input",37),d.Sb(),d.Tb(4,"td"),d.Ob(5,"app-input",38),d.Sb(),d.Tb(6,"td"),d.Ob(7,"app-input",39),d.Sb(),d.Cc(8,te,2,0,"td",40),d.Sb()),2&e){const e=t.index,n=d.dc(2);d.jc("formGroupName",e),d.zb(2),d.Gc(" ",e+1," "),d.zb(1),d.jc("hidden",!0)("ngModel",e+1),d.zb(5),d.jc("ngIf",n.isEdit)}}function ae(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",42),d.ac("click",function(){return d.sc(e),d.dc(3).addTrainingSubjectRow()}),d.Ob(1,"i",43),d.Ec(2," Th\xeam m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng"),d.Sb()}}function ie(e,t){if(1&e&&d.Cc(0,ae,3,0,"button",41),2&e){const e=d.dc(2);d.jc("ngIf",e.isEdit)}}function re(e,t){}function oe(e,t){if(1&e){const e=d.Ub();d.Tb(0,"form",12),d.ac("keydown.enter",function(e){return e.preventDefault()}),d.Tb(1,"nz-card",13),d.Tb(2,"div",14),d.Tb(3,"div",15),d.Tb(4,"app-select-training-form",16),d.ac("onChange",function(t){return d.sc(e),d.dc().onTrainingFormChange(t)}),d.Sb(),d.Sb(),d.Sb(),d.Tb(5,"div",14),d.Tb(6,"div",15),d.Ob(7,"app-input",17),d.Sb(),d.Sb(),d.Tb(8,"div",14),d.Tb(9,"div",18),d.Ob(10,"app-input",19),d.Sb(),d.Tb(11,"div",18),d.Ob(12,"app-input",20),d.Sb(),d.Sb(),d.Tb(13,"div",14),d.Tb(14,"div",15),d.Ob(15,"app-select-organization",21),d.Sb(),d.Sb(),d.Tb(16,"div",14),d.Tb(17,"div",18),d.Ob(18,"app-input",22),d.Sb(),d.Tb(19,"div",18),d.Ob(20,"app-input",23),d.Sb(),d.Sb(),d.Ob(21,"div",14),d.Sb(),d.Tb(22,"nz-card",24),d.Tb(23,"div",25),d.Tb(24,"nz-table",26),d.Tb(25,"thead"),d.Tb(26,"tr"),d.Tb(27,"th",27),d.Ec(28,"STT"),d.Sb(),d.Tb(29,"th"),d.Ec(30,"\u0110\u1ed1i t\u01b0\u1ee3ng"),d.Sb(),d.Tb(31,"th"),d.Ec(32,"S\u1ed1 ti\u1ebft quy \u0111\u1ed5i"),d.Sb(),d.Cc(33,ee,1,0,"th",28),d.Sb(),d.Sb(),d.Tb(34,"tbody",29),d.Cc(35,ne,9,5,"tr",30),d.Sb(),d.Sb(),d.Cc(36,ie,1,1,"ng-template",null,31,d.Dc),d.Cc(38,re,0,0,"ng-template",32,33,d.Dc),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.rc(37),t=d.rc(39),n=d.dc();d.jc("formGroup",n.form),d.zb(4),d.jc("span",2),d.zb(3),d.jc("span",2),d.zb(8),d.jc("span",2),d.zb(9),d.jc("nzShowPagination",!1)("nzNoResult",t)("nzFooter",e),d.zb(9),d.jc("ngIf",n.isEdit),d.zb(2),d.jc("ngForOf",n.trainingSubjects.controls)}}function ce(e,t){if(1&e){const e=d.Ub();d.Tb(0,"form",48),d.Tb(1,"div",14),d.Tb(2,"app-select-department",59),d.ac("onChange",function(t){return d.sc(e),d.dc(3).onChooseDepartment(t)}),d.Sb(),d.Sb(),d.Tb(3,"div",14),d.Tb(4,"app-input",60),d.ac("onChange",function(t){return d.sc(e),d.dc(3).onChooseTrainingSubject(t)}),d.Sb(),d.Sb(),d.Tb(5,"div",14),d.Tb(6,"app-button-delete",10),d.ac("onClick",function(){return d.sc(e),d.dc(3).deleteAll()}),d.Ec(7,"X\xf3a t\u1ea5t c\u1ea3"),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc(3);d.jc("formGroup",e.chooseForm),d.zb(2),d.jc("labelHorizontal",!0)("organizationId",e.internalOrganizationId),d.zb(2),d.jc("labelHorizontal",!0)("selectData",e.trainingSubjects.value)}}function se(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div",55),d.Tb(1,"button",56),d.ac("nzPopoverVisibleChange",function(t){return d.sc(e),d.dc(2).visibleAdvanced=t}),d.Ob(2,"i",57),d.Ec(3," Thi\u1ebft l\u1eadp "),d.Sb(),d.Cc(4,ce,8,5,"ng-template",null,58,d.Dc),d.Sb()}if(2&e){const e=d.rc(5),t=d.dc(2);d.zb(1),d.jc("nzPopoverVisible",t.visibleAdvanced)("nzPopoverContent",e)}}function le(e,t){1&e&&d.Ob(0,"th",34)}function be(e,t){if(1&e){const e=d.Ub();d.Tb(0,"td",36),d.Tb(1,"app-circle-button-delete",10),d.ac("onClick",function(t){d.sc(e);const n=d.dc().index;return d.dc(2).deleteTrainingProgram_UserRow(n),t.stopPropagation()}),d.Sb(),d.Sb()}}function de(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",61),d.Tb(1,"td",62),d.ac("click",function(){d.sc(e);const n=t.index,a=d.dc(2);return a.isEdit?a.activeUser(n):null}),d.Ob(2,"label",63),d.Sb(),d.Tb(3,"td",36),d.Ec(4),d.Sb(),d.Tb(5,"td"),d.Ob(6,"app-input",64),d.Sb(),d.Tb(7,"td"),d.Ob(8,"app-input",65),d.Sb(),d.Tb(9,"td"),d.Ob(10,"app-input",66),d.Sb(),d.Tb(11,"td"),d.Ob(12,"app-input",67),d.Sb(),d.Tb(13,"td",68),d.ac("click",function(e){return e.stopPropagation()}),d.Tb(14,"app-input",69),d.ac("onChange",function(n){d.sc(e);const a=t.index;return d.dc(2).onChangeTrainingSubject(n,a)}),d.Sb(),d.Sb(),d.Tb(15,"td",68),d.ac("click",function(e){return e.stopPropagation()}),d.Ob(16,"app-input",70),d.Sb(),d.Cc(17,be,2,0,"td",40),d.Sb()}if(2&e){const e=t.$implicit,n=t.index,a=d.dc(2);d.jc("formGroupName",n)("hidden",e.value.hidden),d.zb(4),d.Gc(" ",n+1," "),d.zb(10),d.jc("selectData",a.trainingSubjects.value),d.zb(3),d.jc("ngIf",a.isEdit)}}function ue(e,t){if(1&e){const e=d.Ub();d.Tb(0,"form",48),d.Tb(1,"div",14),d.Tb(2,"div",55),d.Tb(3,"app-select-user",72),d.ac("onChange",function(t){return d.sc(e),d.dc(3).onAddUser(t)}),d.Sb(),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc(3);d.jc("formGroup",e.chooseForm)}}function ge(e,t){if(1&e&&d.Cc(0,ue,4,1,"form",71),2&e){const e=d.dc(2);d.jc("ngIf",e.isEdit)}}function me(e,t){}function he(e,t){if(1&e){const e=d.Ub();d.Tb(0,"nz-card"),d.Tb(1,"div",44),d.Tb(2,"div",45),d.Tb(3,"nz-select",46),d.ac("ngModelChange",function(t){return d.sc(e),d.dc().onSearchUser(t)}),d.Sb(),d.Sb(),d.Cc(4,se,6,2,"div",47),d.Sb(),d.Tb(5,"form",48),d.Tb(6,"nz-table",49,50),d.Tb(8,"thead"),d.Tb(9,"tr"),d.Tb(10,"th",51),d.Ec(11,"\u0110D"),d.Sb(),d.Tb(12,"th",51),d.Ec(13,"STT"),d.Sb(),d.Tb(14,"th",52),d.Ec(15,"H\u1ecd t\xean"),d.Sb(),d.Tb(16,"th"),d.Ec(17,"S\u1ed1 CCHN"),d.Sb(),d.Tb(18,"th"),d.Ec(19,"Ch\u1ee9c danh"),d.Sb(),d.Tb(20,"th"),d.Ec(21,"Khoa ph\xf2ng"),d.Sb(),d.Tb(22,"th"),d.Ec(23,"\u0110\u1ed1i t\u01b0\u1ee3ng"),d.Sb(),d.Tb(24,"th",34),d.Ec(25,"Quy \u0111\u1ed5i"),d.Sb(),d.Cc(26,le,1,0,"th",28),d.Sb(),d.Sb(),d.Tb(27,"tbody",53),d.Cc(28,de,18,5,"tr",54),d.Sb(),d.Sb(),d.Cc(29,ge,1,1,"ng-template",null,31,d.Dc),d.Cc(31,me,0,0,"ng-template",32,33,d.Dc),d.Sb(),d.Sb()}if(2&e){const e=d.rc(30),t=d.rc(32),n=d.dc();d.zb(3),d.jc("ngModel",n.listTextSearch),d.zb(1),d.jc("ngIf",n.isEdit),d.zb(1),d.jc("formGroup",n.form),d.zb(1),d.jc("nzNoResult",t)("nzFooter",e)("nzLoading",n.userTableLoading),d.zb(20),d.jc("ngIf",n.isEdit),d.zb(2),d.jc("ngForOf",n.trainingProgram_Users.controls)}}let pe=(()=>{class e extends s.a{constructor(e,t,n){super(e),this.trainingProgramService=t,this.userService=n,this.firstLoad=!0}ngOnInit(){this.form=this.formBuilder.group({trainingFormId:[null,l.s.required],name:[null,l.s.required],code:[null],fromDate:[null],toDate:[null,l.s.required],organizationId:[null],address:[null],note:[null],metaDataObject:this.formBuilder.group({trainingSubjects:this.formBuilder.array([])}),trainingProgram_Users:this.formBuilder.array([])}),this.chooseForm=this.formBuilder.group({chooseDepartmentId:[null],removeDepartmentId:[null],trainingSubject:[null],selectedUserId:[null]}),this.fetchDetail()}fetchDetail(){this.trainingProgramService.getById(this.id).toPromise().then(e=>{e&&e.success?(this.form.patchValue(e.data),e.data.metaDataObject.trainingSubjects.forEach(e=>{this.addTrainingSubjectRow(e)}),e.data.trainingProgram_Users.forEach(e=>{this.addTrainingProgram_UserRow({userId:e.userId,title:e.user.title,department:e.user.department,fullname:e.user.fullname,certificateNumber:e.user.certificateNumber,trainingSubjectName:e.trainingSubjectName,amount:e.amount,active:e.active})}),this.isEdit||this.form.disable()):this.message.error("L\u1ed7i: "+e.message)})}onEdit(){this.isEdit=!0,this.form.enable(),this.trainingProgram_Users.controls.forEach(e=>{e.controls.fullname.disable(),e.controls.certificateNumber.disable(),e.controls.titleName.disable(),e.controls.departmentName.disable()})}onCancel(){this.isModal&&this.modal.destroy()}get trainingSubjects(){return this.form.get("metaDataObject.trainingSubjects")}addTrainingSubjectRow(e){this.trainingSubjects.push(this.createTrainingSubjectItem(e))}deleteTrainingSubjectRow(e){this.trainingSubjects.removeAt(e)}createTrainingSubjectItem(e){return this.formBuilder.group({name:[e?e.name:null,[l.s.required]],code:[e?e.code:null],order:[e?e.order:null],amount:[e?e.amount:null,[l.s.required]]})}get trainingProgram_Users(){return this.form.controls.trainingProgram_Users}addTrainingProgram_UserRow(e){this.trainingProgram_Users.push(this.createTrainingProgram_UserItem(e))}deleteTrainingProgram_UserRow(e){this.trainingProgram_Users.removeAt(e)}createTrainingProgram_UserItem(e){return this.formBuilder.group({userId:[e?e.userId:null,[l.s.required]],fullname:[{value:e?e.fullname:null,disabled:!0}],certificateNumber:[{value:e?e.certificateNumber:null,disabled:!0}],titleName:[{value:e&&e.title?e.title.name:null,disabled:!0}],departmentName:[{value:e&&e.department?e.department.name:null,disabled:!0}],trainingSubjectName:[e?e.trainingSubjectName:null,[l.s.required]],amount:[e?e.amount:null,[l.s.required]],active:[!!e&&e.active],hidden:[null]})}onSave(){for(const e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity();for(const e in this.trainingSubjects.controls){const t=this.trainingSubjects.controls[e];for(const e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()}for(const e in this.trainingProgram_Users.controls){const t=this.trainingProgram_Users.controls[e];for(const e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()}this.form.valid?(this.loading=!0,this.trainingProgramService.update(this.id,this.form.value).toPromise().then(e=>{this.loading=!1,e&&e.success?this.isModal&&(this.message.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"),this.modal.destroy({return:e})):this.message.error("L\u1ed7i: "+e.message)})):this.message.error("Ki\u1ec3m tra l\u1ea1i d\u1eef li\u1ec7u nh\u1eadp")}get internalOrganizationId(){return b.a.INTERNAL_ORGANIZATION_ID}onTrainingFormChange(e){if(this.firstLoad)this.firstLoad=!1;else{for(;this.trainingSubjects.length;)this.trainingSubjects.removeAt(0);e&&e.trainingSubjects&&e.trainingSubjects.forEach(e=>{this.addTrainingSubjectRow(e)})}}onChangeTrainingSubject(e,t){this.trainingProgram_Users.at(t).controls.amount.setValue(e.amount)}activeUser(e){let t=this.trainingProgram_Users.at(e);t.controls.active.setValue(!t.value.active)}onChooseDepartment(e){e&&(this.chooseForm.controls.chooseDepartmentId.reset(),this.userTableLoading=!0,this.userService.getList(1,1e4,"+FirstName","{}",null,e.id).toPromise().then(e=>{if(e&&e.success){const t=this.trainingProgram_Users.getRawValue();e.data.content.forEach(e=>{if(!t.find(t=>t.userId==e.id)){let t=e;t.userId=e.id,t.titleName=e.title.name,t.departmentName=e.department.name,t.active=!1,this.addTrainingProgram_UserRow(t)}})}else this.message.error("L\u1ed7i: "+e.message);this.userTableLoading=!1}))}onRemoveDepartment(e){console,e&&this.chooseForm.controls.removeDepartmentId.reset()}onChooseTrainingSubject(e){if(e){this.chooseForm.controls.trainingSubject.reset();for(const t in this.trainingProgram_Users.controls)this.trainingProgram_Users.controls[t].controls.trainingSubjectName.setValue(e.name)}}deleteAll(){for(;0!==this.trainingProgram_Users.length;)this.trainingProgram_Users.removeAt(0)}onAddUser(e){e&&(this.chooseForm.controls.selectedUserId.reset(),this.trainingProgram_Users.getRawValue().find(t=>t.userId==e.id)?this.message.error(e.fullname+" - "+e.certificateNumber+" \u0111\xe3 t\u1ed3n t\u1ea1i trong danh s\xe1ch"):(e.userId=e.id,e.titleName=e.title?e.title.name:"",e.departmentName=e.department?e.department.name:"",this.addTrainingProgram_UserRow(e)))}onSearchUser(e){this.userTableLoading=!0;for(const t in this.trainingProgram_Users.controls){const n=this.trainingProgram_Users.controls[t],a=n.getRawValue();if(e.length>0){let t=!0;e.forEach(e=>{a.fullname.toLowerCase().includes(e.toLowerCase())||a.certificateNumber.toLowerCase().includes(e.toLowerCase())||a.titleName.toLowerCase().includes(e.toLowerCase())||a.departmentName.toLowerCase().includes(e.toLowerCase())||(t=!1)}),n.controls.hidden.setValue(!t)}else n.controls.hidden.setValue(!1)}this.userTableLoading=!1}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(u.a),d.Nb(g.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-detail-training-program"]],features:[d.wb],decls:14,vars:9,consts:[[1,"page-header"],[3,"onClick",4,"ngIf"],[3,"loading","onClick",4,"ngIf"],[3,"popConfirm","onClick"],["nzType","card"],["nzTitle","Th\xf4ng tin chung"],[4,"ngTemplateOutlet"],["nzTitle","Danh s\xe1ch tham d\u1ef1",3,"nzDisabled"],["commonInfo",""],["participants",""],[3,"onClick"],[3,"loading","onClick"],[3,"formGroup","keydown.enter"],["nzTitle","Th\xf4ng tin ch\u01b0\u01a1ng tr\xecnh \u0111\xe0o t\u1ea1o"],[1,"row"],[1,"col-md-12"],["formControlName","trainingFormId","required","",3,"span","onChange"],["type","text","labelContent","N\u1ed9i dung","formControlName","name","required","",3,"span"],[1,"col-md-6"],["type","datepicker","labelContent","T\u1eeb ng\xe0y","formControlName","fromDate"],["type","datepicker","labelContent","\u0110\u1ebfn ng\xe0y","formControlName","toDate","required",""],["formControlName","organizationId",3,"span"],["type","textarea","labelContent","\u0110\u1ecba \u0111i\u1ec3m t\u1ed5 ch\u1ee9c","formControlName","address"],["type","textarea","labelContent","Ghi ch\xfa","formControlName","note"],["nzTitle","\u0110\u1ed1i t\u01b0\u1ee3ng \u0111\xe0o t\u1ea1o"],["formGroupName","metaDataObject",1,"col-md-12"],["nzBordered","",1,"w-100",3,"nzShowPagination","nzNoResult","nzFooter"],[1,"center"],["width","70px",4,"ngIf"],["formArrayName","trainingSubjects"],[3,"formGroupName",4,"ngFor","ngForOf"],["footerTpl",""],["class","no-result"],["nzNoResult",""],["width","70px"],[3,"formGroupName"],[1,"text-center"],["type","number","formControlName","order",3,"hidden","ngModel"],["type","text","formControlName","name","placeholder","\u0110\u1ed1i t\u01b0\u1ee3ng"],["type","number","formControlName","amount","placeholder","S\u1ed1 ti\u1ebft quy \u0111\u1ed5i"],["class","text-center",4,"ngIf"],["nz-button","",3,"click",4,"ngIf"],["nz-button","",3,"click"],["nz-icon","","nzType","plus"],[1,"row","m-b-10"],[1,"col-md-8"],["nzMode","tags","nzPlaceHolder","T\xecm ki\u1ebfm...",1,"w-100",3,"ngModel","ngModelChange"],["class","col-md-4",4,"ngIf"],[3,"formGroup"],[1,"w-100",3,"nzNoResult","nzFooter","nzLoading"],["dynamicTable",""],["width","50px",1,"center"],["width","200px"],["formArrayName","trainingProgram_Users"],[3,"formGroupName","hidden",4,"ngFor","ngForOf"],[1,"col-md-4"],["nz-button","","nzType","primary","nz-popover","","nzPopoverTitle","Thi\u1ebft l\u1eadp n\xe2ng cao","nzPopoverTrigger","click",1,"w-100",3,"nzPopoverVisible","nzPopoverContent","nzPopoverVisibleChange"],["nz-icon","","nzType","setting"],["advancedTemplate",""],["formControlName","chooseDepartmentId",3,"labelHorizontal","organizationId","onChange"],["type","select","formControlName","trainingSubject","labelContent","\u0110\u1ed1i t\u01b0\u1ee3ng","valueField","name","labelField","name",1,"w-100",3,"labelHorizontal","selectData","onChange"],[3,"formGroupName","hidden"],[1,"text-center",3,"click"],["nz-checkbox","","formControlName","active"],["type","text","formControlName","fullname","placeholder","H\u1ecd t\xean"],["type","text","formControlName","certificateNumber","placeholder","S\u1ed1 CCHN"],["type","text","formControlName","titleName","placeholder","Ch\u1ee9c danh"],["type","text","formControlName","departmentName","placeholder","Khoa ph\xf2ng"],[3,"click"],["type","select","valueField","name","labelField","name","formControlName","trainingSubjectName","placeholder","\u0110\u1ed1i t\u01b0\u1ee3ng",3,"selectData","onChange"],["type","number","formControlName","amount","placeholder","Quy \u0111\u1ed5i"],[3,"formGroup",4,"ngIf"],["labelContent","","placeholder","Th\xeam m\u1ed9t c\xe1n b\u1ed9","formControlName","selectedUserId",3,"onChange"]],template:function(e,t){if(1&e&&(d.Tb(0,"div",0),d.Cc(1,J,1,0,"app-button-edit",1),d.Cc(2,W,1,1,"app-button-save",2),d.Tb(3,"app-button-cancel",3),d.ac("onClick",function(){return t.onCancel()}),d.Sb(),d.Sb(),d.Tb(4,"div"),d.Tb(5,"nz-tabset",4),d.Tb(6,"nz-tab",5),d.Cc(7,Z,1,0,"ng-container",6),d.Sb(),d.Tb(8,"nz-tab",7),d.Cc(9,Y,1,0,"ng-container",6),d.Sb(),d.Sb(),d.Sb(),d.Cc(10,oe,40,9,"ng-template",null,8,d.Dc),d.Cc(12,he,33,8,"ng-template",null,9,d.Dc)),2&e){const e=d.rc(11),n=d.rc(13);d.zb(1),d.jc("ngIf",!t.isEdit),d.zb(1),d.jc("ngIf",t.isEdit),d.zb(1),d.jc("popConfirm",!!t.isEdit),d.zb(1),d.Bb(t.isModal?"m-t-30":""),d.zb(3),d.jc("ngTemplateOutlet",e),d.zb(1),d.jc("nzDisabled",0==t.trainingSubjects.length),d.zb(1),d.jc("ngTemplateOutlet",n)}},directives:[m.n,h.a,p.b,p.a,m.s,f.a,S.a,l.t,l.o,l.i,T.a,D,l.n,l.h,l.r,N.a,x.a,l.j,U.b,U.j,U.k,U.a,U.h,U.e,l.e,m.m,E.a,O.a,F.a,L.a,M.a,_.b,l.p,V.a,A.a,R.a,q.a,Q],styles:[""]}),e})();function fe(e,t){1&e&&d.Pb(0)}function Se(e,t){1&e&&d.Pb(0)}function Te(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",31),d.Tb(1,"td",32),d.Ec(2),d.Ob(3,"app-input",33),d.Sb(),d.Tb(4,"td"),d.Ob(5,"app-input",34),d.Sb(),d.Tb(6,"td"),d.Ob(7,"app-input",35),d.Sb(),d.Tb(8,"td",32),d.Tb(9,"app-circle-button-delete",2),d.ac("onClick",function(){d.sc(e);const n=t.index;return d.dc(2).deleteTrainingSubjectRow(n)}),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=t.index;d.jc("formGroupName",e),d.zb(2),d.Gc(" ",e+1," "),d.zb(1),d.jc("hidden",!0)("ngModel",e+1)}}function Ce(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",36),d.ac("click",function(){return d.sc(e),d.dc(2).addTrainingSubjectRow()}),d.Ob(1,"i",37),d.Ec(2," Th\xeam m\u1ed9t \u0111\u1ed1i t\u01b0\u1ee3ng"),d.Sb()}}function ze(e,t){}function ve(e,t){if(1&e){const e=d.Ub();d.Tb(0,"form",9),d.ac("keydown.enter",function(e){return e.preventDefault()}),d.Tb(1,"nz-card",10),d.Tb(2,"div",11),d.Tb(3,"div",12),d.Tb(4,"app-select-training-form",13),d.ac("onChange",function(t){return d.sc(e),d.dc().onTrainingFormChange(t)}),d.Sb(),d.Sb(),d.Sb(),d.Tb(5,"div",11),d.Tb(6,"div",12),d.Ob(7,"app-input",14),d.Sb(),d.Sb(),d.Tb(8,"div",11),d.Tb(9,"div",15),d.Ob(10,"app-input",16),d.Sb(),d.Tb(11,"div",15),d.Ob(12,"app-input",17),d.Sb(),d.Sb(),d.Tb(13,"div",11),d.Tb(14,"div",12),d.Ob(15,"app-select-organization",18),d.Sb(),d.Sb(),d.Tb(16,"div",11),d.Tb(17,"div",15),d.Ob(18,"app-input",19),d.Sb(),d.Tb(19,"div",15),d.Ob(20,"app-input",20),d.Sb(),d.Sb(),d.Ob(21,"div",11),d.Sb(),d.Tb(22,"nz-card",21),d.Tb(23,"div",22),d.Tb(24,"nz-table",23),d.Tb(25,"thead"),d.Tb(26,"tr"),d.Tb(27,"th",24),d.Ec(28,"STT"),d.Sb(),d.Tb(29,"th"),d.Ec(30,"\u0110\u1ed1i t\u01b0\u1ee3ng"),d.Sb(),d.Tb(31,"th"),d.Ec(32,"S\u1ed1 ti\u1ebft quy \u0111\u1ed5i"),d.Sb(),d.Ob(33,"th",25),d.Sb(),d.Sb(),d.Tb(34,"tbody",26),d.Cc(35,Te,10,4,"tr",27),d.Sb(),d.Sb(),d.Cc(36,Ce,3,0,"ng-template",null,28,d.Dc),d.Cc(38,ze,0,0,"ng-template",29,30,d.Dc),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.rc(37),t=d.rc(39),n=d.dc();d.jc("formGroup",n.form),d.zb(4),d.jc("span",2),d.zb(3),d.jc("span",2),d.zb(8),d.jc("span",2),d.zb(9),d.jc("nzShowPagination",!1)("nzNoResult",t)("nzFooter",e),d.zb(11),d.jc("ngForOf",n.trainingSubjects.controls)}}function je(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div",50),d.Tb(1,"form",51),d.Tb(2,"div",11),d.Tb(3,"app-select-department",52),d.ac("onChange",function(t){return d.sc(e),d.dc(2).onChooseDepartment(t)}),d.Sb(),d.Sb(),d.Tb(4,"div",11),d.Tb(5,"app-input",53),d.ac("onChange",function(t){return d.sc(e),d.dc(2).onChooseTrainingSubject(t)}),d.Sb(),d.Sb(),d.Tb(6,"div",11),d.Tb(7,"app-button-delete",54),d.ac("onClick",function(){return d.sc(e),d.dc(2).deleteAll()}),d.Ec(8,"X\xf3a t\u1ea5t c\u1ea3"),d.Sb(),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc(2);d.zb(1),d.jc("formGroup",e.chooseForm),d.zb(2),d.jc("labelHorizontal",!0)("organizationId",e.internalOrganizationId),d.zb(2),d.jc("labelHorizontal",!0)("selectData",e.trainingSubjects.value)}}function ye(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",55),d.Tb(1,"td",56),d.ac("click",function(){d.sc(e);const n=t.index;return d.dc(2).activeUser(n)}),d.Ob(2,"label",57),d.Sb(),d.Tb(3,"td",32),d.Ec(4),d.Sb(),d.Tb(5,"td"),d.Ob(6,"app-input",58),d.Sb(),d.Tb(7,"td"),d.Ob(8,"app-input",59),d.Sb(),d.Tb(9,"td"),d.Ob(10,"app-input",60),d.Sb(),d.Tb(11,"td"),d.Ob(12,"app-input",61),d.Sb(),d.Tb(13,"td",62),d.ac("click",function(e){return e.stopPropagation()}),d.Tb(14,"app-input",63),d.ac("onChange",function(n){d.sc(e);const a=t.index;return d.dc(2).onChangeTrainingSubject(n,a)}),d.Sb(),d.Sb(),d.Tb(15,"td",62),d.ac("click",function(e){return e.stopPropagation()}),d.Ob(16,"app-input",64),d.Sb(),d.Tb(17,"td",32),d.Tb(18,"app-circle-button-delete",65),d.ac("onClick",function(){d.sc(e);const n=t.index;return d.dc(2).deleteTrainingProgram_UserRow(n)})("click",function(e){return e.stopPropagation()}),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=t.$implicit,n=t.index,a=d.dc(2);d.jc("formGroupName",n)("hidden",e.value.hidden),d.zb(4),d.Gc(" ",n+1," "),d.zb(10),d.jc("selectData",a.trainingSubjects.value)}}function Pe(e,t){if(1&e){const e=d.Ub();d.Tb(0,"form",51),d.Tb(1,"div",11),d.Tb(2,"div",41),d.Tb(3,"app-select-user",66),d.ac("onChange",function(t){return d.sc(e),d.dc(2).onAddUser(t)}),d.Sb(),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc(2);d.jc("formGroup",e.chooseForm)}}function Ne(e,t){}function ke(e,t){if(1&e){const e=d.Ub();d.Tb(0,"nz-card"),d.Tb(1,"div",38),d.Tb(2,"div",39),d.Tb(3,"nz-select",40),d.ac("ngModelChange",function(t){return d.sc(e),d.dc().onSearchUser(t)}),d.Sb(),d.Sb(),d.Tb(4,"div",41),d.Tb(5,"button",42),d.ac("nzPopoverVisibleChange",function(t){return d.sc(e),d.dc().visibleAdvanced=t}),d.Ob(6,"i",43),d.Ec(7," Thi\u1ebft l\u1eadp "),d.Sb(),d.Cc(8,je,9,5,"ng-template",null,44,d.Dc),d.Sb(),d.Sb(),d.Tb(10,"form",9),d.ac("keydown.enter",function(e){return e.preventDefault()}),d.Tb(11,"nz-table",45,46),d.Tb(13,"thead"),d.Tb(14,"tr"),d.Tb(15,"th",47),d.Ec(16,"\u0110D"),d.Sb(),d.Tb(17,"th",47),d.Ec(18,"STT"),d.Sb(),d.Tb(19,"th"),d.Ec(20,"H\u1ecd t\xean"),d.Sb(),d.Tb(21,"th"),d.Ec(22,"S\u1ed1 CCHN"),d.Sb(),d.Tb(23,"th"),d.Ec(24,"Ch\u1ee9c danh"),d.Sb(),d.Tb(25,"th"),d.Ec(26,"Khoa ph\xf2ng"),d.Sb(),d.Tb(27,"th"),d.Ec(28,"\u0110\u1ed1i t\u01b0\u1ee3ng"),d.Sb(),d.Tb(29,"th",25),d.Ec(30,"Quy \u0111\u1ed5i"),d.Sb(),d.Ob(31,"th",25),d.Sb(),d.Sb(),d.Tb(32,"tbody",48),d.Cc(33,ye,19,4,"tr",49),d.Sb(),d.Sb(),d.Cc(34,Pe,4,1,"ng-template",null,28,d.Dc),d.Cc(36,Ne,0,0,"ng-template",29,30,d.Dc),d.Sb(),d.Sb()}if(2&e){const e=d.rc(9),t=d.rc(35),n=d.rc(37),a=d.dc();d.zb(3),d.jc("ngModel",a.listTextSearch),d.zb(2),d.jc("nzPopoverVisible",a.visibleAdvanced)("nzPopoverContent",e),d.zb(5),d.jc("formGroup",a.form),d.zb(1),d.jc("nzNoResult",n)("nzFooter",t)("nzLoading",a.userTableLoading),d.zb(22),d.jc("ngForOf",a.trainingProgram_Users.controls)}}let Ie=(()=>{class e extends s.a{constructor(e,t,n){super(e),this.trainingProgramService=t,this.userService=n}ngOnInit(){this.form=this.formBuilder.group({trainingFormId:[null,l.s.required],name:[null,l.s.required],code:[null],fromDate:[null],toDate:[null,l.s.required],organizationId:[null],address:[null],note:[null],metaDataObject:this.formBuilder.group({trainingSubjects:this.formBuilder.array([])}),trainingProgram_Users:this.formBuilder.array([])}),this.chooseForm=this.formBuilder.group({chooseDepartmentId:[null],removeDepartmentId:[null],trainingSubject:[null],selectedUserId:[null]})}get trainingSubjects(){return this.form.get("metaDataObject.trainingSubjects")}addTrainingSubjectRow(e){this.trainingSubjects.push(this.createTrainingSubjectItem(e))}deleteTrainingSubjectRow(e){this.trainingSubjects.removeAt(e)}createTrainingSubjectItem(e){return this.formBuilder.group({name:[e?e.name:null,[l.s.required]],code:[e?e.code:null],order:[e?e.order:null],amount:[e?e.amount:null,[l.s.required]]})}get trainingProgram_Users(){return this.form.controls.trainingProgram_Users}addTrainingProgram_UserRow(e){this.trainingProgram_Users.push(this.createTrainingProgram_UserItem(e))}deleteTrainingProgram_UserRow(e){this.trainingProgram_Users.removeAt(e)}createTrainingProgram_UserItem(e){return this.formBuilder.group({userId:[e?e.userId:null,[l.s.required]],fullname:[{value:e?e.fullname:null,disabled:!0}],certificateNumber:[{value:e?e.certificateNumber:null,disabled:!0}],titleName:[{value:e&&e.title?e.title.name:null,disabled:!0}],departmentId:[{value:e&&e.department?e.department.id:null,disabled:!0}],departmentName:[{value:e&&e.department?e.department.name:null,disabled:!0}],trainingSubjectName:[null,[l.s.required]],amount:[null,[l.s.required]],active:[!1],hidden:[null]})}onSave(){for(const e in this.form.controls)this.form.controls[e].markAsDirty(),this.form.controls[e].updateValueAndValidity();for(const e in this.trainingSubjects.controls){const t=this.trainingSubjects.controls[e];for(const e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()}for(const e in this.trainingProgram_Users.controls){const t=this.trainingProgram_Users.controls[e];for(const e in t.controls)t.controls[e].markAsDirty(),t.controls[e].updateValueAndValidity()}this.form.valid?(this.loading=!0,this.trainingProgramService.create(this.form.value).toPromise().then(e=>{this.loading=!1,e&&e.success?this.isModal&&(this.message.success("T\u1ea1o m\u1edbi th\xe0nh c\xf4ng"),this.modal.destroy(e.data)):this.message.error("L\u1ed7i: "+e.message)})):this.message.error("Ki\u1ec3m tra l\u1ea1i d\u1eef li\u1ec7u nh\u1eadp")}get internalOrganizationId(){return b.a.INTERNAL_ORGANIZATION_ID}onCancel(){this.isModal&&this.modal.destroy()}onTrainingFormChange(e){for(;this.trainingSubjects.length;)this.trainingSubjects.removeAt(0);e&&e.trainingSubjects&&e.trainingSubjects.forEach(e=>{this.addTrainingSubjectRow(e)})}onChangeTrainingSubject(e,t){this.trainingProgram_Users.at(t).controls.amount.setValue(e.amount)}activeUser(e){let t=this.trainingProgram_Users.at(e);t.controls.active.setValue(!t.value.active)}onChooseDepartment(e){e&&(this.chooseForm.controls.chooseDepartmentId.reset(),this.userTableLoading=!0,this.userService.getList(1,1e4,"+FirstName","{}",null,e.id).toPromise().then(e=>{if(e&&e.success){const t=this.trainingProgram_Users.getRawValue();e.data.content.forEach(e=>{if(!t.find(t=>t.userId==e.id)){let t=e;t.userId=e.id,t.titleName=e.title.name,t.departmentName=e.department.name,this.addTrainingProgram_UserRow(t)}})}else this.message.error("L\u1ed7i: "+e.message);this.userTableLoading=!1}))}onChooseTrainingSubject(e){if(e){this.chooseForm.controls.trainingSubject.reset();for(const t in this.trainingProgram_Users.controls)this.trainingProgram_Users.controls[t].controls.trainingSubjectName.setValue(e.name)}}deleteAll(){for(;0!==this.trainingProgram_Users.length;)this.trainingProgram_Users.removeAt(0)}onAddUser(e){e&&(this.chooseForm.controls.selectedUserId.reset(),this.trainingProgram_Users.getRawValue().find(t=>t.userId==e.id)?this.message.error(e.fullname+" - "+e.certificateNumber+" \u0111\xe3 t\u1ed3n t\u1ea1i trong danh s\xe1ch"):(e.userId=e.id,e.titleName=e.title?e.title.name:"",e.departmentName=e.department?e.department.name:"",this.addTrainingProgram_UserRow(e)))}onSearchUser(e){this.userTableLoading=!0;for(const t in this.trainingProgram_Users.controls){const n=this.trainingProgram_Users.controls[t],a=n.getRawValue();if(e.length>0){let t=!0;e.forEach(e=>{a.fullname.toLowerCase().includes(e.toLowerCase())||a.certificateNumber.toLowerCase().includes(e.toLowerCase())||a.titleName.toLowerCase().includes(e.toLowerCase())||a.departmentName.toLowerCase().includes(e.toLowerCase())||(t=!1)}),n.controls.hidden.setValue(!t)}else n.controls.hidden.setValue(!1)}this.userTableLoading=!1}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(u.a),d.Nb(g.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-create-training-program"]],features:[d.wb],decls:13,vars:7,consts:[[1,"page-header"],[3,"loading","onClick"],[3,"onClick"],["nzType","card"],["nzTitle","Th\xf4ng tin chung"],[4,"ngTemplateOutlet"],["nzTitle","Danh s\xe1ch tham d\u1ef1",3,"nzDisabled"],["commonInfo",""],["participants",""],[3,"formGroup","keydown.enter"],["nzTitle","Th\xf4ng tin ch\u01b0\u01a1ng tr\xecnh \u0111\xe0o t\u1ea1o"],[1,"row"],[1,"col-md-12"],["formControlName","trainingFormId","required","",3,"span","onChange"],["type","text","labelContent","N\u1ed9i dung","formControlName","name","required","",3,"span"],[1,"col-md-6"],["type","datepicker","labelContent","T\u1eeb ng\xe0y","formControlName","fromDate"],["type","datepicker","labelContent","\u0110\u1ebfn ng\xe0y","formControlName","toDate","required",""],["formControlName","organizationId",3,"span"],["type","textarea","labelContent","\u0110\u1ecba \u0111i\u1ec3m t\u1ed5 ch\u1ee9c","formControlName","address"],["type","textarea","labelContent","Ghi ch\xfa","formControlName","note"],["nzTitle","\u0110\u1ed1i t\u01b0\u1ee3ng \u0111\xe0o t\u1ea1o"],["formGroupName","metaDataObject",1,"col-md-12"],["nzBordered","",1,"w-100",3,"nzShowPagination","nzNoResult","nzFooter"],[1,"center"],["width","70px"],["formArrayName","trainingSubjects"],[3,"formGroupName",4,"ngFor","ngForOf"],["footerTpl",""],["class","no-result"],["nzNoResult",""],[3,"formGroupName"],[1,"text-center"],["type","number","formControlName","order",3,"hidden","ngModel"],["type","text","formControlName","name","placeholder","\u0110\u1ed1i t\u01b0\u1ee3ng"],["type","number","formControlName","amount","placeholder","S\u1ed1 ti\u1ebft quy \u0111\u1ed5i"],["nz-button","",3,"click"],["nz-icon","","nzType","plus"],[1,"row","m-b-10"],[1,"col-md-8"],["nzMode","tags","nzPlaceHolder","T\xecm ki\u1ebfm...",1,"w-100",3,"ngModel","ngModelChange"],[1,"col-md-4"],["nz-button","","nzType","primary","nz-popover","","nzPopoverTitle","Thi\u1ebft l\u1eadp n\xe2ng cao","nzPopoverTrigger","click",1,"w-100",3,"nzPopoverVisible","nzPopoverContent","nzPopoverVisibleChange"],["nz-icon","","nzType","setting"],["advancedTemplate",""],[1,"w-100",3,"nzNoResult","nzFooter","nzLoading"],["dynamicTable",""],["width","50px",1,"center"],["formArrayName","trainingProgram_Users"],[3,"formGroupName","hidden",4,"ngFor","ngForOf"],[2,"width","400px"],[3,"formGroup"],["formControlName","chooseDepartmentId",1,"w-100",3,"labelHorizontal","organizationId","onChange"],["type","select","formControlName","trainingSubject","labelContent","\u0110\u1ed1i t\u01b0\u1ee3ng","valueField","name","labelField","name",1,"w-100",3,"labelHorizontal","selectData","onChange"],[1,"w-100",3,"onClick"],[3,"formGroupName","hidden"],[1,"text-center",3,"click"],["nz-checkbox","","formControlName","active"],["type","text","formControlName","fullname","placeholder","H\u1ecd t\xean"],["type","text","formControlName","certificateNumber","placeholder","S\u1ed1 CCHN"],["type","text","formControlName","titleName","placeholder","Ch\u1ee9c danh"],["type","text","formControlName","departmentName","placeholder","Khoa ph\xf2ng"],[3,"click"],["type","select","valueField","name","labelField","name","formControlName","trainingSubjectName","placeholder","\u0110\u1ed1i t\u01b0\u1ee3ng",3,"selectData","onChange"],["type","number","formControlName","amount","placeholder","Quy \u0111\u1ed5i"],[3,"onClick","click"],["labelContent","","placeholder","Th\xeam m\u1ed9t c\xe1n b\u1ed9","formControlName","selectedUserId",3,"onChange"]],template:function(e,t){if(1&e&&(d.Tb(0,"div",0),d.Tb(1,"app-button-save",1),d.ac("onClick",function(){return t.onSave()}),d.Sb(),d.Tb(2,"app-button-cancel",2),d.ac("onClick",function(){return t.onCancel()}),d.Sb(),d.Sb(),d.Tb(3,"div"),d.Tb(4,"nz-tabset",3),d.Tb(5,"nz-tab",4),d.Cc(6,fe,1,0,"ng-container",5),d.Sb(),d.Tb(7,"nz-tab",6),d.Cc(8,Se,1,0,"ng-container",5),d.Sb(),d.Sb(),d.Sb(),d.Cc(9,ve,40,8,"ng-template",null,7,d.Dc),d.Cc(11,ke,38,8,"ng-template",null,8,d.Dc)),2&e){const e=d.rc(10),n=d.rc(12);d.zb(1),d.jc("loading",t.loading),d.zb(2),d.Bb(t.isModal?"m-t-30":""),d.zb(3),d.jc("ngTemplateOutlet",e),d.zb(1),d.jc("nzDisabled",0==t.trainingSubjects.length),d.zb(1),d.jc("ngTemplateOutlet",n)}},directives:[S.a,h.a,p.b,p.a,m.s,l.t,l.o,l.i,T.a,D,l.n,l.h,l.r,N.a,x.a,l.j,U.b,U.j,U.k,U.a,U.h,U.e,l.e,m.m,E.a,O.a,F.a,L.a,M.a,_.b,l.p,V.a,A.a,R.a,q.a,Q],styles:[""]}),e})();var we=n("XlE4"),De=n("tyNb"),xe=n("B+r4"),Ue=n("TAm2"),Ee=n("k8vQ"),Oe=n("bE2y"),Fe=n("3/1E"),Le=n("8X1I"),Me=n("dEAy"),_e=n("Mb3Z"),Ve=n("UIt2");function Ae(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-base",19),d.ac("onClick",function(){return d.sc(e),d.dc().handleChangeDoneStatus()}),d.Ec(1,"X\xe1c nh\u1eadn Ho\xe0n th\xe0nh"),d.Sb()}}function Re(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-export",20),d.ac("onClick",function(){return d.sc(e),d.dc().exportActiveExcel()}),d.Ec(1,"Xu\u1ea5t danh s\xe1ch tham d\u1ef1"),d.Sb()}}function qe(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-base",21),d.ac("onClick",function(){return d.sc(e),d.dc().handleChangeNotDoneStatus()}),d.Ec(1,"Ch\u01b0a ho\xe0n th\xe0nh"),d.Sb()}}function He(e,t){1&e&&d.Ob(0,"th")}function Ge(e,t){if(1&e){const e=d.Ub();d.Tb(0,"td"),d.Tb(1,"app-circle-button-download",32),d.ac("onClick",function(){d.sc(e);const t=d.dc().$implicit;return d.dc().download(t)}),d.Sb(),d.Sb()}}function Be(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",22),d.Tb(1,"td",23),d.ac("click",function(){d.sc(e);const n=t.index,a=d.dc();return a.trainingProgram?"done"==a.trainingProgram.status:a.activeUser(n)}),d.Tb(2,"label",24),d.ac("click",function(e){return e.stopPropagation()})("nzCheckedChange",function(){d.sc(e);const n=t.index;return d.dc().activeUser(n,!0)}),d.Sb(),d.Sb(),d.Tb(3,"td",25),d.Ec(4),d.Sb(),d.Tb(5,"td"),d.Ob(6,"app-input",26),d.Sb(),d.Tb(7,"td"),d.Ob(8,"app-input",27),d.Sb(),d.Tb(9,"td"),d.Ob(10,"app-input",28),d.Sb(),d.Tb(11,"td"),d.Ob(12,"app-input",29),d.Sb(),d.Tb(13,"td"),d.Ob(14,"app-input",30),d.Sb(),d.Tb(15,"td"),d.Tb(16,"app-input",31),d.ac("click",function(e){return e.stopPropagation()}),d.Sb(),d.Sb(),d.Cc(17,Ge,2,0,"td",13),d.Sb()}if(2&e){const e=t.$implicit,n=t.index,a=d.dc();d.jc("formGroupName",n)("hidden",e.value.hidden),d.zb(2),d.jc("nzDisabled",!!a.trainingProgram&&"done"==a.trainingProgram.status),d.zb(2),d.Gc(" ",n+1," "),d.zb(13),d.jc("ngIf",!!a.trainingProgram&&"done"==a.trainingProgram.status&&1==e.value.active)}}function $e(e,t){}function Ke(e,t){}let Xe=(()=>{class e extends Le.a{constructor(e,t){super(e),this.trainingProgramService=t,this.onChangeDoneStatus=new d.n}ngOnInit(){this.form=this.formBuilder.group({trainingFormId:[null],name:[null],code:[null],fromDate:[null],toDate:[null],organizationId:[null],address:[null],note:[null],metaDataObject:this.formBuilder.group({trainingSubjects:this.formBuilder.array([])}),trainingProgram_Users:this.formBuilder.array([])})}openModal(){for(;0!==this.trainingProgram_Users.length;)this.trainingProgram_Users.removeAt(0);this.fetchDetail()}fetchDetail(){this.trainingProgramService.getById(this.id).toPromise().then(e=>{e&&e.success?(this.form.patchValue(e.data),e.data.trainingProgram_Users.forEach(e=>{this.addTrainingProgram_UserRow({userId:e.userId,title:e.user.title,department:e.user.department,fullname:e.user.fullname,certificateNumber:e.user.certificateNumber,trainingSubjectName:e.trainingSubjectName,amount:e.amount,active:e.active,pathToDownload:e.pathToDownload})}),this.form.disable(),this.trainingProgram_Users.controls.forEach(e=>{e.controls.active.enable(),e.controls.hidden.enable()})):this.message.error("L\u1ed7i: "+e.message)})}get trainingProgram_Users(){return this.form.controls.trainingProgram_Users}addTrainingProgram_UserRow(e){this.trainingProgram_Users.push(this.createTrainingProgram_UserItem(e))}createTrainingProgram_UserItem(e){return this.formBuilder.group({userId:[e?e.userId:null,[l.s.required]],fullname:[{value:e?e.fullname:null,disabled:!0}],certificateNumber:[{value:e?e.certificateNumber:null,disabled:!0}],titleName:[{value:e&&e.title?e.title.name:null,disabled:!0}],departmentName:[{value:e&&e.department?e.department.name:null,disabled:!0}],trainingSubjectName:[e?e.trainingSubjectName:null,[l.s.required]],amount:[e?e.amount:null,[l.s.required]],active:[!!e&&e.active],pathToDownload:[!!e&&e.pathToDownload],hidden:[null]})}handleCancel(){this.onCancel.emit()}handleChangeDoneStatus(){this.trainingProgramService.changeStatus(this.id,"done").toPromise().then(e=>{e&&e.success?(this.message.success("Thay \u0111\u1ed5i tr\u1ea1ng th\xe1i th\xe0nh c\xf4ng"),this.onChangeDoneStatus.emit(e.data)):this.message.error("L\u1ed7i: "+e.message)})}handleChangeNotDoneStatus(){this.trainingProgramService.changeStatus(this.id,"").toPromise().then(e=>{e&&e.success?(this.message.success("Thay \u0111\u1ed5i tr\u1ea1ng th\xe1i th\xe0nh c\xf4ng"),this.trainingProgram.status=""):this.message.error("L\u1ed7i: "+e.message)})}onSearchUser(e){this.userTableLoading=!0;for(const t in this.trainingProgram_Users.controls){const n=this.trainingProgram_Users.controls[t],a=n.getRawValue();if(e.length>0){let t=!0;e.forEach(e=>{a.fullname.toLowerCase().includes(e.toLowerCase())||a.certificateNumber.toLowerCase().includes(e.toLowerCase())||a.titleName.toLowerCase().includes(e.toLowerCase())||a.departmentName.toLowerCase().includes(e.toLowerCase())||(t=!1)}),n.controls.hidden.setValue(!t)}else n.controls.hidden.setValue(!1)}this.userTableLoading=!1}activeUser(e,t=!1){let n=this.trainingProgram_Users.at(e);t||n.controls.active.setValue(!n.getRawValue().active);const a={userId:n.getRawValue().userId,trainingProgramId:this.id,active:n.getRawValue().active};this.trainingProgramService.checkin(a).toPromise().then(e=>{e&&e.success||(this.message.error("L\u1ed7i: "+e.message),n.controls.active.setValue(!n.value.active))})}download(e){this.trainingProgramService.downloadCertification(e.getRawValue().pathToDownload).subscribe(t=>{let n=e.getRawValue().fullname.replaceAll(".","-")+".docx";Object(c.b)(t,n)},e=>{this.message.error("L\u1ed7i: "+e.message)})}exportExcel(){this.trainingProgramService.exportParticipants(this.trainingProgram.id).subscribe(e=>{let t=this.trainingProgram.name.replaceAll(".","-")+".xlsx";Object(c.b)(e,t)},e=>{this.message.error("L\u1ed7i: "+e.message)})}exportActiveExcel(){this.trainingProgramService.exportActiveParticipants(this.trainingProgram.id).subscribe(e=>{let t=this.trainingProgram.name.replaceAll(".","-")+".xlsx";Object(c.b)(e,t)},e=>{this.message.error("L\u1ed7i: "+e.message)})}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(u.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-checkin-user-training-program"]],inputs:{trainingProgram:"trainingProgram"},outputs:{onChangeDoneStatus:"onChangeDoneStatus"},features:[d.wb],decls:36,vars:13,consts:[["nzTitle","\u0110i\u1ec3m danh",3,"nzVisible","nzFooter","nzWidth","nzVisibleChange","nzAfterOpen","nzOnCancel"],[1,"row","m-b-10"],[1,"col-md-8"],["nzMode","tags","nzPlaceHolder","T\xecm ki\u1ebfm...",1,"w-100",3,"ngModel","ngModelChange"],[1,"col-md-4"],["iconType","check","buttonType","primary",3,"onClick",4,"ngIf"],["buttonType","primary",3,"onClick",4,"ngIf"],["iconType","close","danger","true","buttonType","link",3,"onClick",4,"ngIf"],[3,"formGroup"],[1,"w-100",3,"nzNoResult","nzLoading"],["dynamicTable",""],["width","50px",1,"center"],["width","70px"],[4,"ngIf"],["formArrayName","trainingProgram_Users"],[3,"formGroupName","hidden",4,"ngFor","ngForOf"],["class","no-result"],["nzNoResult",""],["modalFooter",""],["iconType","check","buttonType","primary",3,"onClick"],["buttonType","primary",3,"onClick"],["iconType","close","danger","true","buttonType","link",3,"onClick"],[3,"formGroupName","hidden"],[1,"text-center",3,"click"],["nz-checkbox","","formControlName","active",3,"nzDisabled","click","nzCheckedChange"],[1,"text-center"],["type","text","formControlName","fullname","placeholder","H\u1ecd t\xean"],["type","text","formControlName","certificateNumber","placeholder","S\u1ed1 CCHN"],["type","text","formControlName","titleName","placeholder","Ch\u1ee9c danh"],["type","text","formControlName","departmentName","placeholder","Khoa ph\xf2ng"],["type","text","formControlName","trainingSubjectName","placeholder","\u0110\u1ed1i t\u01b0\u1ee3ng"],["type","number","formControlName","amount","placeholder","Quy \u0111\u1ed5i",3,"click"],[3,"onClick"]],template:function(e,t){if(1&e&&(d.Tb(0,"nz-modal",0),d.ac("nzVisibleChange",function(e){return t.isVisible=e})("nzAfterOpen",function(){return t.openModal()})("nzOnCancel",function(){return t.handleCancel()}),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Tb(3,"nz-select",3),d.ac("ngModelChange",function(e){return t.onSearchUser(e)}),d.Sb(),d.Sb(),d.Tb(4,"div",4),d.Cc(5,Ae,2,0,"app-button-base",5),d.Cc(6,Re,2,0,"app-button-export",6),d.Cc(7,qe,2,0,"app-button-base",7),d.Sb(),d.Sb(),d.Tb(8,"form",8),d.Tb(9,"nz-table",9,10),d.Tb(11,"thead"),d.Tb(12,"tr"),d.Tb(13,"th",11),d.Ec(14,"\u0110D"),d.Sb(),d.Tb(15,"th",11),d.Ec(16,"STT"),d.Sb(),d.Tb(17,"th"),d.Ec(18,"H\u1ecd t\xean"),d.Sb(),d.Tb(19,"th"),d.Ec(20,"S\u1ed1 CCHN"),d.Sb(),d.Tb(21,"th"),d.Ec(22,"Ch\u1ee9c danh"),d.Sb(),d.Tb(23,"th"),d.Ec(24,"Khoa ph\xf2ng"),d.Sb(),d.Tb(25,"th"),d.Ec(26,"\u0110\u1ed1i t\u01b0\u1ee3ng"),d.Sb(),d.Tb(27,"th",12),d.Ec(28,"Quy \u0111\u1ed5i"),d.Sb(),d.Cc(29,He,1,0,"th",13),d.Sb(),d.Sb(),d.Tb(30,"tbody",14),d.Cc(31,Be,18,5,"tr",15),d.Sb(),d.Sb(),d.Cc(32,$e,0,0,"ng-template",16,17,d.Dc),d.Sb(),d.Sb(),d.Cc(34,Ke,0,0,"ng-template",null,18,d.Dc)),2&e){const e=d.rc(33),n=d.rc(35);d.jc("nzVisible",t.isVisible)("nzFooter",n)("nzWidth",1300)("nzFooter",n),d.zb(3),d.jc("ngModel",t.listTextSearch),d.zb(2),d.jc("ngIf",!!t.trainingProgram&&"done"!==t.trainingProgram.status),d.zb(1),d.jc("ngIf",!!t.trainingProgram&&"done"==t.trainingProgram.status),d.zb(1),d.jc("ngIf",!!t.trainingProgram&&"done"==t.trainingProgram.status),d.zb(1),d.jc("formGroup",t.form),d.zb(1),d.jc("nzNoResult",e)("nzLoading",t.userTableLoading),d.zb(20),d.jc("ngIf",!!t.trainingProgram&&"done"==t.trainingProgram.status),d.zb(2),d.jc("ngForOf",t.trainingProgram_Users.controls)}},directives:[Me.a,_.b,l.n,l.p,m.n,l.t,l.o,l.i,U.b,U.j,U.k,U.a,U.h,U.e,l.e,m.m,k.a,_e.a,l.j,q.a,l.h,N.a,Ve.a],styles:[""]}),e})();var Qe=n("eKRx"),Je=n("N6wO"),We=n("K143"),Ze=n("lhEo"),Ye=n("nJia"),et=n("/SMA"),tt=n("J6Ek"),nt=n("v7J9");function at(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-choose",4),d.ac("onClick",function(){return d.sc(e),d.dc().chooseItem()}),d.Sb()}}function it(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-base",24),d.ac("onClick",function(){d.sc(e);const t=d.dc();return t.openCheckin(t.selectedIds[0])}),d.Ec(1,"\u0110i\u1ec3m danh"),d.Sb()}}function rt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-button-delete",4),d.ac("onClick",function(){d.sc(e);const t=d.dc();return t.deleteMany(t.selectedIds)}),d.Sb()}}function ot(e,t){if(1&e&&d.Ec(0),2&e){const e=t.$implicit,n=d.dc();d.Ic(" ",n.request.pageSize*(n.request.currentPage-1)+1," -",n.request.pageSize*n.request.currentPage>e?e:n.request.pageSize*n.request.currentPage," /",e," ")}}function ct(e,t){1&e&&d.Ob(0,"th",39)}function st(e,t){1&e&&d.Ob(0,"th")}function lt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"td",48),d.ac("nzCheckedChange",function(t){d.sc(e);const n=d.dc().$implicit;return d.dc(2).mapOfCheckedId[n.id]=t})("nzCheckedChange",function(){return d.sc(e),d.dc(3).refreshStatus()})("click",function(e){return e.stopPropagation()}),d.Sb()}if(2&e){const e=d.dc().$implicit,t=d.dc(2);d.jc("nzChecked",t.mapOfCheckedId[e.id])}}function bt(e,t){1&e&&d.Ob(0,"td")}function dt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"td",49),d.ac("nzExpandChange",function(t){return d.sc(e),d.dc().$implicit.expand=t}),d.Sb()}if(2&e){const e=d.dc().$implicit;d.jc("nzExpand",e.expand)}}const ut=function(e){return{"col-group-text":e}};function gt(e,t){if(1&e&&(d.Tb(0,"td",50),d.Ec(1),d.Sb()),2&e){const e=d.dc().$implicit,t=d.dc(2);d.jc("ngClass",d.mc(2,ut,t.expandable)),d.zb(1),d.Gc(" ",e[t.groupBy]," ")}}function mt(e,t){1&e&&(d.Tb(0,"app-tag-done"),d.Ec(1,"\u0110\xe3 k\u1ebft th\xfac"),d.Sb())}function ht(e,t){1&e&&(d.Tb(0,"app-tag-not-done"),d.Ec(1,"Ch\u01b0a k\u1ebft th\xfac"),d.Sb())}function pt(e,t){if(1&e&&(d.Tb(0,"div"),d.Tb(1,"strong"),d.Ec(2),d.Sb(),d.Ec(3," / "),d.Tb(4,"span"),d.Ec(5),d.Sb(),d.Sb()),2&e){const e=d.dc().$implicit;d.zb(2),d.Fc(e.totalParticipantMeetOnDate),d.zb(3),d.Fc(e.totalParticipant)}}function ft(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-circle-button-delete",4),d.ac("onClick",function(){d.sc(e);const t=d.dc(2).$implicit;return d.dc(2).deleteMany([t.id])}),d.Sb()}}function St(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"app-circle-button-download",51),d.ac("onClick",function(){d.sc(e);const t=d.dc().$implicit;return d.dc(2).downloadCertifications(t)}),d.Sb(),d.Tb(2,"app-circle-button-base",52),d.ac("onClick",function(){d.sc(e);const t=d.dc().$implicit;return d.dc(2).openCheckin(t)}),d.Sb(),d.Tb(3,"app-circle-button-edit",4),d.ac("onClick",function(){d.sc(e);const t=d.dc().$implicit;return d.dc(2).goToDetail(t.id,!0)}),d.Sb(),d.Cc(4,ft,1,0,"app-circle-button-delete",5),d.Qb()}if(2&e){const e=d.dc().$implicit,t=d.dc(2);d.zb(1),d.jc("disabled","done"!==e.status||"HTHN"!==e.trainingForm.code),d.zb(3),d.jc("ngIf",!t.isModal)}}function Tt(e,t){1&e&&(d.Tb(0,"app-tag-done"),d.Ec(1,"\u0110\xe3 k\u1ebft th\xfac"),d.Sb())}function Ct(e,t){1&e&&(d.Tb(0,"app-tag-not-done"),d.Ec(1,"Ch\u01b0a k\u1ebft th\xfac"),d.Sb())}function zt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"app-circle-button-delete",4),d.ac("onClick",function(){d.sc(e);const t=d.dc().$implicit;return d.dc(3).deleteMany([t.id])}),d.Sb()}}function vt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",53),d.ac("click",function(){d.sc(e);const n=t.$implicit;return d.dc(3).goToDetail(n.id)}),d.Tb(1,"td",54),d.ac("nzCheckedChange",function(n){d.sc(e);const a=t.$implicit;return d.dc(3).mapOfCheckedId[a.id]=n})("nzCheckedChange",function(){return d.sc(e),d.dc(3).refreshStatus()}),d.Sb(),d.Ob(2,"td"),d.Ob(3,"td"),d.Tb(4,"td",44),d.Ec(5),d.Sb(),d.Tb(6,"td"),d.Ec(7),d.Sb(),d.Tb(8,"td",45),d.Ec(9),d.Sb(),d.Tb(10,"td"),d.Ec(11),d.ec(12,"date"),d.Sb(),d.Tb(13,"td"),d.Ec(14),d.ec(15,"date"),d.Sb(),d.Tb(16,"td"),d.Cc(17,Tt,2,0,"app-tag-done",22),d.Cc(18,Ct,2,0,"app-tag-not-done",22),d.Sb(),d.Tb(19,"td",46),d.ac("click",function(e){return e.stopPropagation()}),d.Tb(20,"app-circle-button-base",52),d.ac("onClick",function(){d.sc(e);const n=t.$implicit;return d.dc(3).openCheckin(n.id)}),d.Sb(),d.Tb(21,"app-circle-button-edit",4),d.ac("onClick",function(){d.sc(e);const n=t.$implicit;return d.dc(3).goToDetail(n.id,!0)}),d.Sb(),d.Cc(22,zt,1,0,"app-circle-button-delete",5),d.Sb(),d.Sb()}if(2&e){const e=t.$implicit,n=t.index,a=d.dc().$implicit,i=d.dc(2);d.jc("nzExpand",a.expand),d.zb(1),d.jc("nzChecked",i.mapOfCheckedId[e.id]),d.zb(4),d.Fc(i.request.pageSize*(i.request.currentPage-1)+(n+1)),d.zb(2),d.Fc(e.trainingForm.name),d.zb(2),d.Fc(e.name),d.zb(2),d.Fc(d.gc(12,10,e.fromDate,"dd/MM/yyyy")),d.zb(3),d.Fc(d.gc(15,13,e.toDate,"dd/MM/yyyy")),d.zb(3),d.jc("ngIf","done"==e.status),d.zb(1),d.jc("ngIf","done"!=e.status),d.zb(4),d.jc("ngIf",!i.isModal)}}const jt=function(e){return{"col-group":e}};function yt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",40),d.ac("click",function(){d.sc(e);const n=t.$implicit,a=d.dc(2);return!a.expandable&&a.goToDetail(n.id)}),d.Cc(1,lt,1,1,"td",41),d.Cc(2,bt,1,0,"td",22),d.Cc(3,dt,1,1,"td",42),d.Cc(4,gt,2,4,"td",43),d.Tb(5,"td",44),d.Ec(6),d.Sb(),d.Tb(7,"td"),d.Ec(8),d.Sb(),d.Tb(9,"td",45),d.Ec(10),d.Sb(),d.Tb(11,"td"),d.Ec(12),d.ec(13,"date"),d.Sb(),d.Tb(14,"td"),d.Ec(15),d.ec(16,"date"),d.Sb(),d.Tb(17,"td"),d.Cc(18,mt,2,0,"app-tag-done",22),d.Cc(19,ht,2,0,"app-tag-not-done",22),d.Sb(),d.Tb(20,"td",44),d.Cc(21,pt,6,2,"div",22),d.Sb(),d.Tb(22,"td",46),d.ac("click",function(e){return e.stopPropagation()}),d.Cc(23,St,5,2,"ng-container",22),d.Sb(),d.Sb(),d.Cc(24,vt,23,16,"tr",47)}if(2&e){const e=t.index,n=t.$implicit,a=d.dc(2);d.jc("ngClass",d.mc(21,jt,a.expandable)),d.zb(1),d.jc("ngIf",!a.expandable),d.zb(1),d.jc("ngIf",a.expandable),d.zb(1),d.jc("ngIf",a.expandable),d.zb(1),d.jc("ngIf",a.expandable),d.zb(2),d.Fc(a.expandable?"":a.request.pageSize*(a.request.currentPage-1)+(e+1)),d.zb(2),d.Fc(a.expandable?"":n.trainingForm.name),d.zb(2),d.Fc(a.expandable?"":n.name),d.zb(2),d.Fc(a.expandable?"":d.gc(13,15,n.fromDate,"dd/MM/yyyy")),d.zb(3),d.Fc(a.expandable?"":d.gc(16,18,n.toDate,"dd/MM/yyyy")),d.zb(3),d.jc("ngIf","done"==n.status),d.zb(1),d.jc("ngIf","done"!=n.status),d.zb(2),d.jc("ngIf",!a.expandable),d.zb(2),d.jc("ngIf",!a.expandable),d.zb(1),d.jc("ngForOf",n.children)}}function Pt(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"nz-card"),d.Tb(2,"nz-table",25,26),d.ac("nzCurrentPageDataChange",function(t){return d.sc(e),d.dc().currentPageDataChange(t)}),d.Tb(4,"thead",27),d.ac("nzSortChange",function(t){return d.sc(e),d.dc().sortChange(t)}),d.Tb(5,"tr"),d.Tb(6,"th",28),d.ac("nzCheckedChange",function(t){return d.sc(e),d.dc().isAllDisplayDataChecked=t})("nzCheckedChange",function(t){return d.sc(e),d.dc().checkAll(t)}),d.Sb(),d.Cc(7,ct,1,0,"th",29),d.Cc(8,st,1,0,"th",22),d.Tb(9,"th",30),d.Ec(10,"STT "),d.Sb(),d.Tb(11,"th",31),d.Ec(12," H\xecnh th\u1ee9c \u0111\xe0o t\u1ea1o "),d.Sb(),d.Tb(13,"th",32),d.Ec(14," N\u1ed9i dung "),d.Sb(),d.Tb(15,"th",33),d.Ec(16," T\u1eeb ng\xe0y "),d.Sb(),d.Tb(17,"th",34),d.Ec(18," \u0110\u1ebfn ng\xe0y "),d.Sb(),d.Tb(19,"th",35),d.Ec(20," Tr\u1ea1ng th\xe1i "),d.Sb(),d.Tb(21,"th",36),d.Ec(22," Ng\u01b0\u1eddi tham d\u1ef1 "),d.Sb(),d.Tb(23,"th",37),d.Ec(24," Thao t\xe1c "),d.Sb(),d.Sb(),d.Sb(),d.Tb(25,"tbody"),d.Cc(26,yt,25,23,"ng-template",38),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=d.rc(3),t=d.dc();d.zb(2),d.jc("nzData",t.listData)("nzFrontPagination",!1)("nzLoading",t.isLoading),d.zb(4),d.jc("nzChecked",t.isAllDisplayDataChecked)("nzIndeterminate",t.isIndeterminate),d.zb(1),d.jc("ngIf",t.expandable),d.zb(1),d.jc("ngIf",t.expandable),d.zb(18),d.jc("ngForOf",e.data)}}function Nt(e,t){1&e&&(d.Tb(0,"app-tag-done"),d.Ec(1,"\u0110\xe3 k\u1ebft th\xfac"),d.Sb())}function kt(e,t){1&e&&(d.Tb(0,"app-tag-not-done"),d.Ec(1,"Ch\u01b0a k\u1ebft th\xfac"),d.Sb())}function It(e,t){if(1&e&&(d.Tb(0,"app-card-item",56),d.Ec(1),d.Sb(),d.Tb(2,"app-card-item",57),d.Ec(3),d.Sb(),d.Tb(4,"app-card-item",58),d.Ec(5),d.ec(6,"date"),d.Sb(),d.Tb(7,"app-card-item",59),d.Ec(8),d.ec(9,"date"),d.Sb(),d.Tb(10,"app-card-item",60),d.Cc(11,Nt,2,0,"app-tag-done",22),d.Cc(12,kt,2,0,"app-tag-not-done",22),d.Sb()),2&e){const e=t.item;d.zb(1),d.Gc(" ",e.trainingForm.name," "),d.zb(2),d.Gc(" ",e.name," "),d.zb(2),d.Gc(" ",d.gc(6,6,e.fromDate,"dd/MM/yyyy")," "),d.zb(3),d.Gc(" ",d.gc(9,9,e.toDate,"dd/MM/yyyy")," "),d.zb(3),d.jc("ngIf","done"==e.status),d.zb(1),d.jc("ngIf","done"!=e.status)}}function wt(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"app-card-view",55),d.ac("onClick",function(t){return d.sc(e),d.dc().goToDetail(t.id)}),d.Cc(2,It,13,12,"ng-template"),d.Sb(),d.Qb()}if(2&e){const e=d.dc();d.zb(1),d.jc("expandable",e.expandable)("listData",e.listData)("groupBy",e.groupBy)}}const Dt=function(){return[10,20,50,100]},xt=[{path:"",component:(()=>{class e extends we.a{constructor(e,t,n,a,i){super(e),this.modalService=t,this.router=n,this.route=a,this.trainingProgramService=i,this.request={listTextSearch:[],currentPage:1,pageSize:20,sort:"-ToDate"}}ngOnInit(){this.searchForm=this.formBuilder.group({fromDate:[null],toDate:[null],trainingFormId:[null]}),this.route.paramMap.subscribe(e=>{e.params&&e.params.trainingFormId&&this.searchForm.controls.trainingFormId.setValue(e.params.trainingFormId),this.fetchList()})}fetchList(){const e=JSON.stringify({ListTextSearch:this.request.listTextSearch});this.isLoading=!0,this.trainingProgramService.getList(this.request.currentPage,this.request.pageSize,this.request.sort,e,this.searchForm.value.fromDate,this.searchForm.value.toDate,this.searchForm.value.trainingFormId).toPromise().then(e=>{this.isLoading=!1,e&&e.success?(this.listData=e.data.content,this.flatList=e.data.content,this.total=e.data.totalRecords,this.parseGroup(this.listData)):this.message.error(e.message)})}reload(){this.request.listTextSearch=[],this.fetchList()}goToCreate(){this.modalService.openCreateModal(Ie,"1300px","20px").afterClose.toPromise().then(e=>{e&&this.reload()})}goToDetail(e,t=!1){this.modalService.openDetailModal(pe,e,t,"1300px","20px").afterClose.toPromise().then(e=>{e&&this.reload()})}chooseItem(){this.modal.destroy({id:this.selectedIds[0]})}openCheckin(e){this.selectedItem=e,this.checkinIsVisible=!0}deleteMany(e){this.isLoading=!0,this.trainingProgramService.deleteMany(e).toPromise().then(e=>{this.isLoading=!1,e&&e.success?(this.message.success("X\xf3a th\xe0nh c\xf4ng"),this.fetchList()):this.message.error("L\u1ed7i: "+e.message)})}downloadCertifications(e){this.trainingProgramService.downloadCertifications(e.pathToDownload).subscribe(t=>{let n=this.listData.find(t=>t.id==e.id).name.replaceAll(".","-")+".zip";Object(c.b)(t,n)},e=>{this.message.error("L\u1ed7i: "+e.message)})}exportCertifications(e){const t=this.message.loading("\u0110ang x\u1eed l\xfd..",{nzDuration:0}).messageId;this.trainingProgramService.exportCertifications(e).toPromise().then(n=>{if(this.message.remove(t),n){let t=this.listData.find(t=>t.id==e).name.replaceAll(".","-")+".zip";Object(c.b)(n,t)}else this.message.warning("L\u1ed7i: Kh\xf4ng c\xf3 ng\u01b0\u1eddi tham d\u1ef1",{nzDuration:1e4})})}onChangeDoneStatus(e){this.checkinIsVisible=!1,this.reload(),"HTHN"==e.trainingForm.code&&this.exportCertifications(e.id)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(j.a),d.Nb(De.e),d.Nb(De.a),d.Nb(u.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-list-training-program"]],features:[d.wb],decls:40,vars:27,consts:[[1,"page-header"],[1,"row"],[1,"col-md-5"],["nz-row",""],[3,"onClick"],[3,"onClick",4,"ngIf"],["iconType","check-square","buttonType","primary",3,"onClick",4,"ngIf"],[1,"col-md-7"],["nzMode","tags","nzPlaceHolder","T\xecm ki\u1ebfm...",1,"w-100",3,"ngModel","ngModelChange"],[1,"col-md-12"],[1,"float-right",3,"ngModel","nzButtonStyle","ngModelChange"],["nz-radio-button","","nzValue","list"],["nz-icon","","nzType","bars","nzTheme","outline"],["nz-radio-button","","nzValue","card"],["nz-icon","","nzType","appstore","nzTheme","outline"],["nzShowSizeChanger","",1,"float-right","mr-2",3,"nzPageSize","nzPageSizeOptions","nzPageIndex","nzShowTotal","nzTotal","nzPageSizeChange","nzPageIndexChange","nzTotalChange"],["totalTemplate",""],[3,"formGroup"],[1,"col-md-4"],["type","datepicker","formControlName","fromDate","labelContent","T\u1eeb ng\xe0y",3,"labelHorizontal","onChange"],["type","datepicker","formControlName","toDate","labelContent","\u0110\u1ebfn ng\xe0y",3,"labelHorizontal","onChange"],["formControlName","trainingFormId",3,"labelHorizontal","onChange"],[4,"ngIf"],[3,"id","isVisible","trainingProgram","onCancel","onChangeDoneStatus"],["iconType","check-square","buttonType","primary",3,"onClick"],[1,"w-100",3,"nzData","nzFrontPagination","nzLoading","nzCurrentPageDataChange"],["rowSelectionTable",""],[3,"nzSortChange"],["nzShowCheckbox","","nzWidth","50px",1,"center",3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzWidth","50px","nzShowExpand","",4,"ngIf"],["nzWidth","50px",1,"center"],["width","200px"],["nzShowSort","","nzSortKey","name"],["width","150px","nzShowSort","","nzSortKey","fromDate"],["width","150px","nzShowSort","","nzSortKey","toDate"],["width","150px","nzShowSort","","nzSortKey","status"],["width","150px",1,"center"],["width","200px",1,"center"],["ngFor","",3,"ngForOf"],["nzWidth","50px","nzShowExpand",""],[3,"ngClass","click"],["nzShowCheckbox","",3,"nzChecked","nzCheckedChange","click",4,"ngIf"],["class","center","nzShowExpand","",3,"nzExpand","nzExpandChange",4,"ngIf"],[3,"ngClass",4,"ngIf"],[1,"center"],[1,"text-highlight"],[1,"center",3,"click"],[3,"nzExpand","click",4,"ngFor","ngForOf"],["nzShowCheckbox","",3,"nzChecked","nzCheckedChange","click"],["nzShowExpand","",1,"center",3,"nzExpand","nzExpandChange"],[3,"ngClass"],[3,"disabled","onClick"],["buttonType","primary","iconType","check-square","nz-tooltip","","nzTooltipTitle","\u0110i\u1ec3m danh",3,"onClick"],[3,"nzExpand","click"],["nzShowCheckbox","",3,"nzChecked","nzCheckedChange"],[3,"expandable","listData","groupBy","onClick"],["label","H\xecnh th\u1ee9c \u0111\xe0o t\u1ea1o"],["label","N\u1ed9i dung"],["label","T\u1eeb ng\xe0y"],["label","\u0110\u1ebfn ng\xe0y"],["label","Tr\u1ea1ng th\xe1i"]],template:function(e,t){if(1&e&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Tb(3,"div",3),d.Tb(4,"app-header-title"),d.Ec(5,"Danh s\xe1ch ch\u01b0\u01a1ng tr\xecnh \u0111\xe0o t\u1ea1o"),d.Sb(),d.Sb(),d.Tb(6,"div",3),d.Tb(7,"app-button-reload",4),d.ac("onClick",function(){return t.reload()}),d.Sb(),d.Tb(8,"app-button-create",4),d.ac("onClick",function(){return t.goToCreate()}),d.Sb(),d.Cc(9,at,1,0,"app-button-choose",5),d.Cc(10,it,2,0,"app-button-base",6),d.Cc(11,rt,1,0,"app-button-delete",5),d.Sb(),d.Sb(),d.Tb(12,"div",7),d.Tb(13,"div",3),d.Tb(14,"nz-select",8),d.ac("ngModelChange",function(e){return t.nzOnSearch(e)}),d.Sb(),d.Sb(),d.Tb(15,"div",1),d.Tb(16,"div",9),d.Tb(17,"nz-radio-group",10),d.ac("ngModelChange",function(e){return t.tableType=e}),d.Tb(18,"label",11),d.Tb(19,"span"),d.Ob(20,"i",12),d.Sb(),d.Sb(),d.Tb(21,"label",13),d.Tb(22,"span"),d.Ob(23,"i",14),d.Sb(),d.Sb(),d.Sb(),d.Tb(24,"nz-pagination",15),d.ac("nzPageSizeChange",function(e){return t.request.pageSize=e})("nzPageIndexChange",function(e){return t.request.currentPage=e})("nzPageIndexChange",function(e){return t.pageIndexChange(e)})("nzPageSizeChange",function(e){return t.pageSizeChange(e)})("nzTotalChange",function(e){return t.total=e}),d.Sb(),d.Cc(25,ot,1,3,"ng-template",null,16,d.Dc),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(27,"form",17),d.Tb(28,"div",1),d.Tb(29,"div",18),d.Tb(30,"app-input",19),d.ac("onChange",function(){return t.fetchList()}),d.Sb(),d.Sb(),d.Tb(31,"div",18),d.Tb(32,"app-input",20),d.ac("onChange",function(){return t.fetchList()}),d.Sb(),d.Sb(),d.Tb(33,"div",18),d.Tb(34,"app-select-training-form",21),d.ac("onChange",function(){return t.fetchList()}),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(35,"div",1),d.Tb(36,"div"),d.Cc(37,Pt,27,8,"ng-container",22),d.Cc(38,wt,3,3,"ng-container",22),d.Sb(),d.Sb(),d.Tb(39,"app-checkin-user-training-program",23),d.ac("onCancel",function(){return t.checkinIsVisible=!1,t.reload()})("onChangeDoneStatus",function(e){return t.onChangeDoneStatus(e)}),d.Sb()),2&e){const e=d.rc(26);d.zb(9),d.jc("ngIf",t.isModal&&1==t.selectedIds.length),d.zb(1),d.jc("ngIf",!t.isModal&&1==t.selectedIds.length),d.zb(1),d.jc("ngIf",!t.isModal&&t.selectedIds.length>1&&(t.isAllDisplayDataChecked||t.isIndeterminate)),d.zb(3),d.jc("ngModel",t.listTextSearch),d.zb(3),d.jc("ngModel",t.tableType)("nzButtonStyle","solid"),d.zb(7),d.jc("nzPageSize",t.request.pageSize)("nzPageSizeOptions",d.lc(26,Dt))("nzPageIndex",t.request.currentPage)("nzShowTotal",e)("nzTotal",t.total),d.zb(3),d.jc("formGroup",t.searchForm),d.zb(3),d.jc("labelHorizontal",!1),d.zb(2),d.jc("labelHorizontal",!1),d.zb(2),d.jc("labelHorizontal",!1),d.zb(1),d.Bb(t.isModal?"m-t-30":""),d.zb(1),d.Bb(t.isModal?"w-100 center":"col-lg-12 center"),d.zb(1),d.jc("ngIf","list"==t.tableType),d.zb(1),d.jc("ngIf","card"==t.tableType),d.zb(1),d.jc("id",t.selectedItem?t.selectedItem.id:null)("isVisible",t.checkinIsVisible)("trainingProgram",t.selectedItem)}},directives:[xe.c,Ue.a,Ee.a,I.a,m.n,_.b,l.n,l.p,Oe.c,Oe.b,Oe.a,L.a,M.a,Fe.a,l.t,l.o,l.i,N.a,l.h,D,Xe,Qe.a,k.a,R.a,T.a,U.b,U.j,U.k,U.a,U.h,U.i,U.g,U.e,m.m,m.l,U.f,Je.a,We.a,Ve.a,Ze.a,Ye.d,et.a,E.a,U.l,U.c,tt.a,nt.a],pipes:[m.e],styles:[""]}),e})()}];let Ut=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[De.i.forChild(xt)],De.i]}),e})();var Et=n("uRpX"),Ot=n("PCNd");let Ft=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[m.c,Ot.a,Et.a,Ut,o.TrainingFormModule,r.OrganizationModule,i.DepartmentModule,a.UserModule]]}),e})()}}]);